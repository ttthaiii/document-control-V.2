(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{83638:function(e,s,t){Promise.resolve().then(t.bind(t,9602)),Promise.resolve().then(t.bind(t,20731))},41671:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});const r=(0,t(79205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},99388:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});const r=(0,t(79205).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},92735:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});const r=(0,t(79205).Z)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},48736:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});const r=(0,t(79205).Z)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},17689:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});const r=(0,t(79205).Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},95805:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});const r=(0,t(79205).Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},9602:function(e,s,t){"use strict";t.d(s,{InviteUserForm:function(){return b}});var r=t(57437),a=t(2265),l=t(29501),n=t(47649),i=t(453),c=t(79205);const d=(0,c.Z)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var o=t(95805),m=t(41671);const x=(0,c.Z)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var h=t(48736),u=t(92735),N=t(17689),p=t(99388);function b(){const{firebaseUser:e}=(0,n.a)(),[s,t]=(0,a.useState)("single"),[c,b]=(0,a.useState)(!1),[g,E]=(0,a.useState)(null),[y,j]=(0,a.useState)(null),[f,v]=(0,a.useState)(null),[I,P]=(0,a.useState)([]),[w,R]=(0,a.useState)(null),[_,M]=(0,a.useState)([]),[D,A]=(0,a.useState)(!0),[S,k]=(0,a.useState)([]),{register:C,handleSubmit:O,reset:T,formState:{errors:V}}=(0,l.cI)();(0,a.useEffect)((()=>{(async()=>{if(e)try{const s=await e.getIdToken(),t=await fetch("/api/sites",{headers:{Authorization:"Bearer ".concat(s)}}),r=await t.json();r.success&&M(r.sites)}catch(s){console.error("Failed to fetch sites",s)}finally{A(!1)}})()}),[e]);const F=e=>{try{const s=e.split("\n").map((e=>e.trim())).filter((e=>e));if(s.length<2)throw new Error("\u0e44\u0e1f\u0e25\u0e4c CSV \u0e27\u0e48\u0e32\u0e07\u0e40\u0e1b\u0e25\u0e48\u0e32\u0e2b\u0e23\u0e37\u0e2d\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a\u0e44\u0e21\u0e48\u0e16\u0e39\u0e01\u0e15\u0e49\u0e2d\u0e07");const t=s[0].replace(/^\uFEFF/,"").split(",").map((e=>e.trim().toLowerCase().replace(/[\r\n"]/g,"")));if(!t.includes("email")||!t.includes("role"))throw new Error("CSV \u0e15\u0e49\u0e2d\u0e07\u0e21\u0e35\u0e04\u0e2d\u0e25\u0e31\u0e21\u0e19\u0e4c Email \u0e41\u0e25\u0e30 Role \u0e40\u0e1b\u0e47\u0e19\u0e2d\u0e22\u0e48\u0e32\u0e07\u0e19\u0e49\u0e2d\u0e22");const r=[];for(let e=1;e<s.length;e++){const a=s[e].split(",").map((e=>e.trim().replace(/^"|"$/g,"")));if(a.length<t.length)continue;const l={};t.forEach(((e,s)=>{l[e]=a[s]}));const n={email:l.email,name:l.name||l.fullname||"",role:l.role||l.position||"",employeeId:l.employeeid||l.id||l.empid||l.employee_id||""};n.email&&r.push(n)}if(0===r.length)throw new Error("\u0e44\u0e21\u0e48\u0e1e\u0e1a\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e17\u0e35\u0e48\u0e16\u0e39\u0e01\u0e15\u0e49\u0e2d\u0e07\u0e43\u0e19\u0e44\u0e1f\u0e25\u0e4c");P(r)}catch(s){console.error("CSV Parse Error:",s),R(s.message),P([])}};return(0,r.jsxs)("div",{className:"max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-lg border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"\u0e40\u0e0a\u0e34\u0e0d\u0e1c\u0e39\u0e49\u0e43\u0e0a\u0e49\u0e43\u0e2b\u0e21\u0e48"}),(0,r.jsxs)("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[(0,r.jsxs)("button",{onClick:()=>t("single"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors flex items-center ".concat("single"===s?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"),children:[(0,r.jsx)(d,{size:16,className:"mr-2"})," \u0e17\u0e35\u0e25\u0e30\u0e04\u0e19"]}),(0,r.jsxs)("button",{onClick:()=>t("batch"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors flex items-center ".concat("batch"===s?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"),children:[(0,r.jsx)(o.Z,{size:16,className:"mr-2"})," Import CSV"]})]})]}),"single"===s&&(0,r.jsxs)("form",{onSubmit:O((async s=>{b(!0),E(null);try{const t=await(null===e||void 0===e?void 0:e.getIdToken()),r=await fetch("/api/admin/invite",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(s)}),a=await r.json();a.success?(E({success:!0,invitationUrl:a.invitationUrl,warning:a.warning}),T()):E({success:!1,error:a.error})}catch(t){E({success:!1,error:"Network error"})}finally{b(!1)}})),className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["\u0e23\u0e2b\u0e31\u0e2a\u0e1e\u0e19\u0e31\u0e01\u0e07\u0e32\u0e19 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",...C("employeeId",{required:"\u0e08\u0e33\u0e40\u0e1b\u0e47\u0e19"}),className:"w-full px-3 py-2 border rounded-md bg-white text-gray-900",placeholder:"EMP-001"}),V.employeeId&&(0,r.jsx)("span",{className:"text-xs text-red-500",children:"\u0e01\u0e23\u0e38\u0e13\u0e32\u0e01\u0e23\u0e2d\u0e01\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["\u0e0a\u0e37\u0e48\u0e2d-\u0e19\u0e32\u0e21\u0e2a\u0e01\u0e38\u0e25 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",...C("name",{required:"\u0e08\u0e33\u0e40\u0e1b\u0e47\u0e19"}),className:"w-full px-3 py-2 border rounded-md bg-white text-gray-900",placeholder:"\u0e2a\u0e21\u0e0a\u0e32\u0e22 \u0e43\u0e08\u0e14\u0e35"}),V.name&&(0,r.jsx)("span",{className:"text-xs text-red-500",children:"\u0e01\u0e23\u0e38\u0e13\u0e32\u0e01\u0e23\u0e2d\u0e01\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["\u0e2d\u0e35\u0e40\u0e21\u0e25 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"email",...C("email",{required:"\u0e08\u0e33\u0e40\u0e1b\u0e47\u0e19"}),className:"w-full px-3 py-2 border rounded-md bg-white text-gray-900",placeholder:"user@example.com"}),V.email&&(0,r.jsx)("span",{className:"text-xs text-red-500",children:"\u0e01\u0e23\u0e38\u0e13\u0e32\u0e01\u0e23\u0e2d\u0e01\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["\u0e15\u0e33\u0e41\u0e2b\u0e19\u0e48\u0e07 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("select",{...C("role",{required:"\u0e08\u0e33\u0e40\u0e1b\u0e47\u0e19"}),className:"w-full p-2 border rounded-md bg-white text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"-- \u0e40\u0e25\u0e37\u0e2d\u0e01 --"}),Object.values(i.K$).map((e=>(0,r.jsx)("option",{value:e,children:e},e)))]}),V.role&&(0,r.jsx)("span",{className:"text-xs text-red-500",children:"\u0e01\u0e23\u0e38\u0e13\u0e32\u0e40\u0e25\u0e37\u0e2d\u0e01"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),D?(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Loading..."}):(0,r.jsx)("div",{className:"mt-1 p-3 border rounded-md max-h-32 overflow-y-auto grid grid-cols-1 sm:grid-cols-2 gap-2",children:_.map((e=>(0,r.jsxs)("label",{className:"flex items-center text-sm",children:[(0,r.jsx)("input",{type:"checkbox",...C("sites",{required:!0}),value:e.id,className:"mr-2 text-blue-600 rounded"}),e.name]},e.id)))}),V.sites&&(0,r.jsx)("span",{className:"text-xs text-red-500",children:"\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e2d\u0e22\u0e48\u0e32\u0e07\u0e19\u0e49\u0e2d\u0e22 1 \u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23"})]}),(0,r.jsx)("button",{type:"submit",disabled:c,className:"w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 disabled:bg-blue-300",children:c?"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e2a\u0e48\u0e07...":"\u0e2a\u0e48\u0e07\u0e04\u0e33\u0e40\u0e0a\u0e34\u0e0d"}),g&&(0,r.jsx)("div",{className:"mt-4 p-4 rounded border ".concat(g.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:g.success?(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(m.Z,{className:"w-5 h-5 text-green-600 mr-2 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-green-800",children:"\u0e2a\u0e33\u0e40\u0e23\u0e47\u0e08!"}),(0,r.jsx)("p",{className:"text-sm text-green-700",children:g.warning||"\u0e2a\u0e48\u0e07\u0e2d\u0e35\u0e40\u0e21\u0e25\u0e40\u0e23\u0e35\u0e22\u0e1a\u0e23\u0e49\u0e2d\u0e22\u0e41\u0e25\u0e49\u0e27"}),(0,r.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,r.jsx)("input",{readOnly:!0,value:g.invitationUrl,className:"text-xs border rounded px-2 py-1 w-full"}),(0,r.jsx)("button",{onClick:()=>navigator.clipboard.writeText(g.invitationUrl),className:"p-1 bg-gray-200 rounded",children:(0,r.jsx)(x,{size:14})})]})]})]}):(0,r.jsxs)("p",{className:"text-red-700 text-sm",children:["Error: ",g.error]})})]}),"batch"===s&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:[(0,r.jsxs)("h3",{className:"text-sm font-semibold text-blue-800 mb-2 flex items-center",children:[(0,r.jsx)(h.Z,{size:16,className:"mr-2"})," \u0e04\u0e33\u0e41\u0e19\u0e30\u0e19\u0e33\u0e01\u0e32\u0e23\u0e40\u0e15\u0e23\u0e35\u0e22\u0e21\u0e44\u0e1f\u0e25\u0e4c"]}),(0,r.jsxs)("p",{className:"text-xs text-blue-600 mb-3",children:["\u0e44\u0e1f\u0e25\u0e4c CSV \u0e15\u0e49\u0e2d\u0e07\u0e21\u0e35\u0e2b\u0e31\u0e27\u0e15\u0e32\u0e23\u0e32\u0e07: ",(0,r.jsx)("code",{className:"bg-blue-100 px-1 rounded",children:"Email, Name, EmployeeId, Role"})]}),(0,r.jsxs)("button",{onClick:()=>{const e=new Blob(["\ufeffEmail,Name,EmployeeId,Role\nuser1@example.com,Somchai Jaidee,EMP001,BIM\nuser2@example.com,Somsri Rakngan,EMP002,Site Admin"],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.setAttribute("download","ttsdoc_invite_template.csv"),document.body.appendChild(t),t.click(),document.body.removeChild(t)},className:"text-xs flex items-center text-blue-700 hover:underline",children:[(0,r.jsx)(u.Z,{size:14,className:"mr-1"})," \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14\u0e44\u0e1f\u0e25\u0e4c\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07 (Template)"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["1. \u0e40\u0e25\u0e37\u0e2d\u0e01\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (\u0e08\u0e30\u0e16\u0e39\u0e01\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e43\u0e2b\u0e49\u0e17\u0e38\u0e01\u0e04\u0e19\u0e43\u0e19\u0e44\u0e1f\u0e25\u0e4c) ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("div",{className:"p-3 border rounded-md max-h-32 overflow-y-auto grid grid-cols-1 sm:grid-cols-2 gap-2 bg-gray-50",children:_.map((e=>(0,r.jsxs)("label",{className:"flex items-center text-sm",children:[(0,r.jsx)("input",{type:"checkbox",checked:S.includes(e.id),onChange:s=>{return t=e.id,r=s.target.checked,void k((e=>r?[...e,t]:e.filter((e=>e!==t))));var t,r},className:"mr-2 text-blue-600 rounded"}),e.name]},e.id)))}),0===S.length&&(0,r.jsx)("p",{className:"text-xs text-red-500 mt-1",children:"* \u0e01\u0e23\u0e38\u0e13\u0e32\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e2d\u0e22\u0e48\u0e32\u0e07\u0e19\u0e49\u0e2d\u0e22 1 \u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"2. \u0e2d\u0e31\u0e1b\u0e42\u0e2b\u0e25\u0e14\u0e44\u0e1f\u0e25\u0e4c CSV"}),(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-500 transition-colors",children:[(0,r.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var s;const t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!t)return;v(t),R(null),j(null);const r=new FileReader;r.onload=e=>{var s;const t=null===(s=e.target)||void 0===s?void 0:s.result;F(t)},r.readAsText(t)},className:"hidden",id:"csv-upload"}),(0,r.jsxs)("label",{htmlFor:"csv-upload",className:"cursor-pointer flex flex-col items-center",children:[(0,r.jsx)(N.Z,{size:32,className:"text-gray-400 mb-2"}),(0,r.jsx)("span",{className:"text-sm text-gray-600 font-medium",children:"\u0e04\u0e25\u0e34\u0e01\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e44\u0e1f\u0e25\u0e4c CSV"}),(0,r.jsx)("span",{className:"text-xs text-gray-400 mt-1",children:"\u0e2b\u0e23\u0e37\u0e2d\u0e25\u0e32\u0e01\u0e44\u0e1f\u0e25\u0e4c\u0e21\u0e32\u0e27\u0e32\u0e07\u0e17\u0e35\u0e48\u0e19\u0e35\u0e48"})]})]}),f&&(0,r.jsxs)("div",{className:"mt-2 flex items-center justify-between bg-gray-50 p-2 rounded text-sm",children:[(0,r.jsx)("span",{className:"truncate font-medium",children:f.name}),(0,r.jsxs)("span",{className:"text-green-600 text-xs bg-green-100 px-2 py-0.5 rounded-full",children:["\u0e1e\u0e1a ",I.length," \u0e23\u0e32\u0e22\u0e01\u0e32\u0e23"]})]}),w&&(0,r.jsx)("p",{className:"text-xs text-red-500 mt-2",children:w})]}),I.length>0&&(0,r.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25 (5 \u0e23\u0e32\u0e22\u0e01\u0e32\u0e23\u0e41\u0e23\u0e01)"}),(0,r.jsxs)("table",{className:"min-w-full text-xs text-left",children:[(0,r.jsx)("thead",{className:"bg-white border-b",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-3 py-2",children:"Email"}),(0,r.jsx)("th",{className:"px-3 py-2",children:"Name"}),(0,r.jsx)("th",{className:"px-3 py-2",children:"ID"}),(0,r.jsx)("th",{className:"px-3 py-2",children:"Role"})]})}),(0,r.jsx)("tbody",{children:I.slice(0,5).map(((e,s)=>(0,r.jsxs)("tr",{className:"border-b last:border-0",children:[(0,r.jsx)("td",{className:"px-3 py-2 truncate max-w-[120px]",children:e.email}),(0,r.jsx)("td",{className:"px-3 py-2 truncate max-w-[100px]",children:e.name}),(0,r.jsx)("td",{className:"px-3 py-2",children:e.employeeId}),(0,r.jsx)("td",{className:"px-3 py-2",children:e.role})]},s)))})]}),I.length>5&&(0,r.jsxs)("div",{className:"px-3 py-1 text-xs text-gray-500 bg-gray-50 text-center",children:["...\u0e41\u0e25\u0e30\u0e2d\u0e35\u0e01 ",I.length-5," \u0e23\u0e32\u0e22\u0e01\u0e32\u0e23"]})]}),(0,r.jsx)("button",{onClick:async()=>{if(0!==I.length&&0!==S.length){b(!0),j(null),R(null);try{const s=await(null===e||void 0===e?void 0:e.getIdToken());console.log("Sending Batch Data:",{users:I,sites:S});const t=await fetch("/api/admin/invite/batch",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({users:I,sites:S})}),r=await t.json();if(r.success){j(r.summary),P([]),v(null);const e=document.getElementById("csv-upload");e&&(e.value="")}else R(r.error||"\u0e40\u0e01\u0e34\u0e14\u0e02\u0e49\u0e2d\u0e1c\u0e34\u0e14\u0e1e\u0e25\u0e32\u0e14\u0e43\u0e19\u0e01\u0e32\u0e23\u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25")}catch(s){R("Network error while sending batch request")}finally{b(!1)}}},disabled:c||0===I.length||0===S.length,className:"w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed transition-colors",children:c?"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e1b\u0e23\u0e30\u0e21\u0e27\u0e25\u0e1c\u0e25...":"\u0e19\u0e33\u0e40\u0e02\u0e49\u0e32\u0e41\u0e25\u0e30\u0e2a\u0e48\u0e07\u0e04\u0e33\u0e40\u0e0a\u0e34\u0e0d ".concat(I.length," \u0e23\u0e32\u0e22\u0e01\u0e32\u0e23")}),y&&(0,r.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 border rounded-lg",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:"\u0e2a\u0e23\u0e38\u0e1b\u0e1c\u0e25\u0e01\u0e32\u0e23\u0e19\u0e33\u0e40\u0e02\u0e49\u0e32"}),(0,r.jsxs)("div",{className:"flex gap-4 text-sm mb-3",children:[(0,r.jsxs)("span",{className:"text-green-600 flex items-center",children:[(0,r.jsx)(m.Z,{size:16,className:"mr-1"})," \u0e2a\u0e33\u0e40\u0e23\u0e47\u0e08: ",y.success]}),(0,r.jsxs)("span",{className:"text-red-600 flex items-center",children:[(0,r.jsx)(p.Z,{size:16,className:"mr-1"})," \u0e25\u0e49\u0e21\u0e40\u0e2b\u0e25\u0e27: ",y.failed]})]}),y.details.filter((e=>"error"===e.status)).length>0&&(0,r.jsxs)("div",{className:"max-h-32 overflow-y-auto border-t pt-2",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-red-500 mb-1",children:"\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23\u0e17\u0e35\u0e48\u0e1c\u0e34\u0e14\u0e1e\u0e25\u0e32\u0e14:"}),(0,r.jsx)("ul",{className:"space-y-1",children:y.details.filter((e=>"error"===e.status)).map(((e,s)=>(0,r.jsxs)("li",{className:"text-xs text-gray-600 flex justify-between",children:[(0,r.jsx)("span",{children:e.email}),(0,r.jsx)("span",{className:"text-red-500",children:e.reason})]},s)))})]})]})]})]})}},20731:function(e,s,t){"use strict";t.d(s,{AuthGuard:function(){return c}});var r=t(57437),a=t(47649),l=t(99376),n=t(2265);t(453);const i=()=>(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"bg-white shadow",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-32"}),(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-24"})]})})}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"w-64 bg-white border-r border-gray-200 min-h-screen",children:(0,r.jsx)("div",{className:"p-4 space-y-3",children:[...Array(6)].map(((e,s)=>(0,r.jsx)("div",{className:"h-10 bg-gray-100 rounded"},s)))})}),(0,r.jsx)("div",{className:"flex-1 p-8",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[...Array(3)].map(((e,s)=>(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded mb-4"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]},s)))})]})})]})]})});function c(e){let{children:s,requiredRoles:t=[],requiredSiteAccess:c=[],fallback:d,redirectTo:o="/login"}=e;const{user:m,loading:x,error:h}=(0,a.a)(),u=(0,l.useRouter)();if((0,n.useEffect)((()=>{x||m||u.push(o)}),[m,x,u,o]),x)return(0,r.jsx)(i,{});if(h)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsx)("div",{className:"text-center max-w-md mx-auto",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"\u0e40\u0e01\u0e34\u0e14\u0e02\u0e49\u0e2d\u0e1c\u0e34\u0e14\u0e1e\u0e25\u0e32\u0e14"}),(0,r.jsx)("p",{className:"text-red-600 mb-4",children:h}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"\u0e25\u0e2d\u0e07\u0e43\u0e2b\u0e21\u0e48"})]})})});if(!m)return d?(0,r.jsx)(r.Fragment,{children:d}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"\u0e01\u0e23\u0e38\u0e13\u0e32\u0e40\u0e02\u0e49\u0e32\u0e2a\u0e39\u0e48\u0e23\u0e30\u0e1a\u0e1a"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"\u0e04\u0e38\u0e13\u0e15\u0e49\u0e2d\u0e07\u0e40\u0e02\u0e49\u0e32\u0e2a\u0e39\u0e48\u0e23\u0e30\u0e1a\u0e1a\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e40\u0e02\u0e49\u0e32\u0e16\u0e36\u0e07\u0e2b\u0e19\u0e49\u0e32\u0e19\u0e35\u0e49"}),(0,r.jsx)("button",{onClick:()=>u.push(o),className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition-colors",children:"\u0e40\u0e02\u0e49\u0e32\u0e2a\u0e39\u0e48\u0e23\u0e30\u0e1a\u0e1a"})]})});if(t.length>0){if(!t.includes(m.role))return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsx)("div",{className:"text-center max-w-md mx-auto",children:(0,r.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"\u0e44\u0e21\u0e48\u0e21\u0e35\u0e2a\u0e34\u0e17\u0e18\u0e34\u0e4c\u0e40\u0e02\u0e49\u0e32\u0e16\u0e36\u0e07"}),(0,r.jsx)("p",{className:"text-yellow-700 mb-2",children:"\u0e04\u0e38\u0e13\u0e44\u0e21\u0e48\u0e21\u0e35\u0e2a\u0e34\u0e17\u0e18\u0e34\u0e4c\u0e40\u0e02\u0e49\u0e32\u0e16\u0e36\u0e07\u0e2b\u0e19\u0e49\u0e32\u0e19\u0e35\u0e49"}),(0,r.jsxs)("p",{className:"text-sm text-yellow-600 mb-4",children:["\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23\u0e2a\u0e34\u0e17\u0e18\u0e34\u0e4c: ",t.join(", ")," | \u0e2a\u0e34\u0e17\u0e18\u0e34\u0e4c\u0e1b\u0e31\u0e08\u0e08\u0e38\u0e1a\u0e31\u0e19: ",m.role]}),(0,r.jsx)("button",{onClick:()=>u.back(),className:"bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 transition-colors",children:"\u0e22\u0e49\u0e2d\u0e19\u0e01\u0e25\u0e31\u0e1a"})]})})})}if(c.length>0&&"Admin"!==m.role){if(!c.some((e=>{var s;return null===(s=m.sites)||void 0===s?void 0:s.includes(e)})))return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsx)("div",{className:"text-center max-w-md mx-auto",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"\u0e44\u0e21\u0e48\u0e21\u0e35\u0e2a\u0e34\u0e17\u0e18\u0e34\u0e4c\u0e40\u0e02\u0e49\u0e32\u0e16\u0e36\u0e07\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23"}),(0,r.jsx)("p",{className:"text-red-600 mb-4",children:"\u0e04\u0e38\u0e13\u0e44\u0e21\u0e48\u0e21\u0e35\u0e2a\u0e34\u0e17\u0e18\u0e34\u0e4c\u0e40\u0e02\u0e49\u0e32\u0e16\u0e36\u0e07\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23\u0e17\u0e35\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23"}),(0,r.jsx)("button",{onClick:()=>u.back(),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"\u0e22\u0e49\u0e2d\u0e19\u0e01\u0e25\u0e31\u0e1a"})]})})})}return(0,r.jsx)(r.Fragment,{children:s})}},453:function(e,s,t){"use strict";t.d(s,{$p:function(){return i},Ge:function(){return d},K$:function(){return r},NK:function(){return o},c9:function(){return n},gf:function(){return l},n$:function(){return c},oU:function(){return a},yh:function(){return m}});const r={ADMIN:"Admin",BIM:"BIM",SITE_ADMIN:"Site Admin",CM:"CM",ME:"ME",SN:"SN",OE:"OE",PE:"PE",PM:"PM",PD:"PD",SE:"SE",FM:"FM",ADMIN_SITE_2:"Adminsite2"},a=(r.BIM,r.ME,r.SN,r.SITE_ADMIN,r.ADMIN,r.PM,r.PE,r.OE,[r.SITE_ADMIN,r.ADMIN_SITE_2,r.OE,r.PE,r.ADMIN]),l=[r.CM,r.ADMIN,r.SITE_ADMIN,r.PM,r.PE,r.OE],n=(r.PM,r.ADMIN,r.SE,r.FM,[r.PE,r.OE,r.ADMIN]),i=[r.PM,r.ADMIN],c=(r.PD,r.SE,r.FM,{PENDING_REVIEW:"PENDING_REVIEW",PENDING_CM_APPROVAL:"PENDING_CM_APPROVAL",REVISION_REQUIRED:"REVISION_REQUIRED",APPROVED:"APPROVED",APPROVED_WITH_COMMENTS:"APPROVED_WITH_COMMENTS",APPROVED_REVISION_REQUIRED:"APPROVED_REVISION_REQUIRED",REJECTED:"REJECTED",PENDING_FINAL_APPROVAL:"PENDING_FINAL_APPROVAL"}),d={DRAFT:"DRAFT",REJECTED_BY_PM:"REJECTED_BY_PM",PENDING_BIM:"PENDING_BIM",IN_PROGRESS:"IN_PROGRESS",PENDING_ACCEPTANCE:"PENDING_ACCEPTANCE",REVISION_REQUESTED:"REVISION_REQUESTED",COMPLETED:"COMPLETED"},o={[c.PENDING_REVIEW]:"\u0e23\u0e2d\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a",[c.PENDING_CM_APPROVAL]:"\u0e23\u0e2d\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34 (CM/Approver)",[c.REVISION_REQUIRED]:"\u0e41\u0e01\u0e49\u0e44\u0e02",[c.APPROVED]:"\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34",[c.APPROVED_WITH_COMMENTS]:"\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34\u0e15\u0e32\u0e21\u0e04\u0e2d\u0e21\u0e40\u0e21\u0e19\u0e15\u0e4c (\u0e44\u0e21\u0e48\u0e41\u0e01\u0e49\u0e44\u0e02)",[c.APPROVED_REVISION_REQUIRED]:"\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34\u0e15\u0e32\u0e21\u0e04\u0e2d\u0e21\u0e40\u0e21\u0e19\u0e15\u0e4c (\u0e15\u0e49\u0e2d\u0e07\u0e41\u0e01\u0e49\u0e44\u0e02)",[c.REJECTED]:"\u0e44\u0e21\u0e48\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34",[c.PENDING_FINAL_APPROVAL]:"\u0e23\u0e2d SITE \u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34\u0e02\u0e31\u0e49\u0e19\u0e2a\u0e38\u0e14\u0e17\u0e49\u0e32\u0e22",[d.DRAFT]:"\u0e23\u0e2d\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34 (PM)",[d.REJECTED_BY_PM]:"\u0e44\u0e21\u0e48\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34 (PM)",[d.PENDING_BIM]:"\u0e23\u0e2d BIM \u0e23\u0e31\u0e1a\u0e07\u0e32\u0e19",[d.IN_PROGRESS]:"BIM \u0e01\u0e33\u0e25\u0e31\u0e07\u0e14\u0e33\u0e40\u0e19\u0e34\u0e19\u0e01\u0e32\u0e23",[d.PENDING_ACCEPTANCE]:"\u0e23\u0e2d\u0e15\u0e23\u0e27\u0e08\u0e23\u0e31\u0e1a (Site)",[d.REVISION_REQUESTED]:"\u0e02\u0e2d\u0e41\u0e01\u0e49\u0e44\u0e02 (WR)",[d.COMPLETED]:"\u0e40\u0e2a\u0e23\u0e47\u0e08\u0e2a\u0e34\u0e49\u0e19"},m={[c.PENDING_REVIEW]:"#3B82F6",[c.PENDING_CM_APPROVAL]:"#8B5CF6",[c.REVISION_REQUIRED]:"#F59E0B",[c.APPROVED]:"#22C55E",[c.REJECTED]:"#EF4444",[c.APPROVED_WITH_COMMENTS]:"#15803d",[c.APPROVED_REVISION_REQUIRED]:"#F97316",[c.PENDING_FINAL_APPROVAL]:"#6366F1",[d.DRAFT]:"#6B7280",[d.REJECTED_BY_PM]:"#EF4444",[d.PENDING_BIM]:"#3B82F6",[d.IN_PROGRESS]:"#F59E0B",[d.PENDING_ACCEPTANCE]:"#A855F7",[d.REVISION_REQUESTED]:"#F97316",[d.COMPLETED]:"#22C55E"}}},function(e){e.O(0,[609,15,134,583,649,971,997,744],(function(){return s=83638,e(e.s=s);var s}));var s=e.O();_N_E=s}]);