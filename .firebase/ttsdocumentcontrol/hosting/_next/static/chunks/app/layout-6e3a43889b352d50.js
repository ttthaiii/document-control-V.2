(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{6276:function(e,t,n){Promise.resolve().then(n.t.bind(n,4811,23)),Promise.resolve().then(n.t.bind(n,2778,23)),Promise.resolve().then(n.bind(n,5946))},5946:function(e,t,n){"use strict";n.d(t,{AuthProvider:function(){return s},a:function(){return c}});var r=n(2265),a=n(2148),o=n(5978),l=n(6855);let u=(0,r.createContext)({user:null,firebaseUser:null,loading:!0,error:null,refetch:async()=>{},logout:async()=>{}});function s(e){let{children:t}=e,[n,s]=(0,r.useState)(null),[c,i]=(0,r.useState)(null),[d,f]=(0,r.useState)(!0),[h,m]=(0,r.useState)(null),v=async e=>{try{m(null);let r=await (0,o.QT)((0,o.JU)(l.db,"users",e.uid));if(r.exists()){var t,n;let a=r.data();i({id:e.uid,email:e.email||"",role:a.role,sites:a.sites||[],status:a.status||"ACTIVE",createdFromInvitation:a.createdFromInvitation,createdAt:null===(t=a.createdAt)||void 0===t?void 0:t.toDate(),acceptedAt:null===(n=a.acceptedAt)||void 0===n?void 0:n.toDate()})}else m("ไม่พบข้อมูลผู้ใช้ในระบบ"),i(null)}catch(e){console.error("Error fetching user data:",e),m("เกิดข้อผิดพลาดในการโหลดข้อมูลผู้ใช้"),i(null)}},y=async()=>{n&&await v(n)};(0,r.useEffect)(()=>{let e=(0,a.Aj)(l.I,async e=>{try{f(!0),s(e),e?await v(e):(i(null),m(null))}catch(e){console.error("Auth state change error:",e),m("เกิดข้อผิดพลาดในการตรวจสอบสิทธิ์")}finally{f(!1)}});return()=>e()},[]);let _=async()=>{try{await (0,a.w7)(l.I),i(null),s(null),m(null)}catch(e){throw console.error("Logout error:",e),e}};return r.createElement(u.Provider,{value:{user:c,firebaseUser:n,loading:d,error:h,refetch:y,logout:_}},t)}function c(){return(0,r.useContext)(u)}},6855:function(e,t,n){"use strict";n.d(t,{I:function(){return u},db:function(){return s}});var r=n(738),a=n(2148),o=n(5978);let l=(0,r.C6)().length>0?(0,r.C6)()[0]:(0,r.ZF)({apiKey:"AIzaSyAsayb-DEOBE0zi0qh-dPBfihClgXrX1sY",authDomain:"ttsdocumentcontrol.firebaseapp.com",projectId:"ttsdocumentcontrol",storageBucket:"ttsdocumentcontrol.firebasestorage.app",messagingSenderId:"48440915675",appId:"1:48440915675:web:f11611895bfb52d4d27efe"}),u=(0,a.v0)(l),s=(0,o.ad)(l)},2778:function(){},4811:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[2,609,15,351,971,117,744],function(){return e(e.s=6276)}),_N_E=e.O()}]);