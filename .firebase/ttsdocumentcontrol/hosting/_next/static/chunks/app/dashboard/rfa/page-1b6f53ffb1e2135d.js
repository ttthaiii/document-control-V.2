(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[571],{1417:function(e,t,s){Promise.resolve().then(s.bind(s,1015))},1015:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return T}});var a=s(7437),r=s(2265),l=s(9376),n=s(5946),i=s(731),c=s(1313),d=s(44),o=s(2720),x=s(2369),u=s(1047),m=s(1723),h=s(453);let p=[h.n$.PENDING_REVIEW,h.n$.PENDING_CM_APPROVAL,h.n$.REVISION_REQUIRED,h.n$.APPROVED_REVISION_REQUIRED],y=e=>{if(!e)return null;if("function"==typeof e.toDate)return e.toDate();if(e._seconds)return new Date(1e3*e._seconds);let t=new Date(e);return isNaN(t.getTime())?null:t};function g(e){let{documents:t,onDocumentClick:s,getStatusColor:l,statusLabels:n,getRFATypeColor:i}=e,[c,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=()=>g(window.innerWidth<=768);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let N=e=>{let t=y(e);return t?t.toLocaleDateString("th-TH",{day:"2-digit",month:"2-digit",year:"numeric"}):"Invalid Date"},f=e=>{let t=y(e.updatedAt);if(!t)return 0;let s=new Date;s.setHours(0,0,0,0);let a=new Date(t);return a.setHours(0,0,0,0),Math.max(0,Math.floor((s.getTime()-a.getTime())/864e5))},v=e=>{var t,s,a,r;switch(e.status){case h.n$.PENDING_REVIEW:return{name:"Site",role:"Site"};case h.n$.PENDING_CM_APPROVAL:return{name:"CM",role:"CM"};case h.n$.REVISION_REQUIRED:case h.n$.APPROVED_REVISION_REQUIRED:return{name:(null===(t=e.createdByInfo)||void 0===t?void 0:t.role)||"Creator",role:(null===(s=e.createdByInfo)||void 0===s?void 0:s.role)||"Creator"};case h.n$.REJECTED:return e.isLatest?{name:(null===(a=e.createdByInfo)||void 0===a?void 0:a.role)||"Creator",role:(null===(r=e.createdByInfo)||void 0===r?void 0:r.role)||"Creator"}:{name:"เสร็จสิ้น",role:"Completed"};case h.n$.APPROVED:case h.n$.APPROVED_WITH_COMMENTS:return{name:"เสร็จสิ้น",role:"Completed"};default:return{name:"N/A",role:"N/A"}}};return c?(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>{var t,r;let c=v(e),h=f(e);return(0,a.jsxs)("div",{onClick:()=>s(e),className:"bg-white rounded-lg shadow border p-4 cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsx)("span",{className:"inline-flex px-2 py-1 rounded-full text-xs font-medium ".concat(i(e.rfaType)),children:e.rfaType}),(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 bg-gray-200 text-gray-800 rounded-full text-xs font-semibold",children:["REV-",String(e.revisionNumber).padStart(2,"0")]})]}),(0,a.jsx)("h3",{className:"font-medium text-gray-900 text-sm mb-1 truncate",children:e.documentNumber}),(0,a.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.title})]}),(0,a.jsx)("div",{className:"flex flex-col items-end space-y-1 flex-shrink-0 ml-2",children:(0,a.jsx)("span",{className:"inline-flex items-center justify-center px-2 py-1 rounded-full text-xs font-medium ".concat(l(e.status)),children:n[e.status]||e.status})})]}),(0,a.jsxs)("div",{className:"space-y-2 text-xs text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(d.Z,{className:"w-3 h-3 mr-2"}),(0,a.jsx)("span",{children:(null===(t=e.site)||void 0===t?void 0:t.name)||"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(o.Z,{className:"w-3 h-3 mr-2"}),(0,a.jsx)("span",{children:(null===(r=e.category)||void 0===r?void 0:r.categoryCode)||"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(x.Z,{className:"w-3 h-3 mr-2"}),(0,a.jsxs)("span",{children:["ผู้รับผิดชอบ: ",c.name]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(u.Z,{className:"w-3 h-3 mr-2"}),(0,a.jsxs)("span",{children:["อัปเดต: ",N(e.updatedAt)]})]}),p.includes(e.status)&&h>0&&(0,a.jsxs)("div",{className:"flex items-center text-orange-600",children:[(0,a.jsx)(m.Z,{className:"w-3 h-3 mr-2"}),(0,a.jsxs)("span",{children:["ค้างดำเนินการ: ",h," วัน"]})]})]})]},e.id)})}):(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"System No."}),(0,a.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"หมวดหมู่"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เอกสาร"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rev."}),(0,a.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สถานะ"}),(0,a.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ผู้รับผิดชอบ"}),(0,a.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"วันที่อัปเดตล่าสุด"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>{var t;let r=v(e),i=f(e);return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>s(e),children:[(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("p",{className:"text-sm font-semibold text-blue-600 text-center",children:e.runningNumber||"N/A"})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"text-sm",children:(0,a.jsx)("p",{className:"text-gray-600 text-center",children:(null===(t=e.category)||void 0===t?void 0:t.categoryCode)||"N/A"})})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.documentNumber}),(0,a.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.title})]})}),(0,a.jsx)("td",{className:"px-4 py-4 text-center",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold bg-gray-200 text-gray-800",children:String(e.revisionNumber).padStart(2,"0")})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-1 items-center",children:[(0,a.jsx)("span",{className:"inline-flex items-center justify-center px-2 py-1 rounded-full text-xs font-medium ".concat(l(e.status)),children:n[e.status]||e.status}),p.includes(e.status)&&i>0&&(0,a.jsx)("span",{className:"text-xs text-orange-600 text-center",children:"ค้าง ".concat(i," วัน")})]})}),(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 text-gray-400 mr-2"}),(0,a.jsx)("div",{className:"text-sm",children:(0,a.jsx)("p",{className:"text-gray-900",children:r.name})})]})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"text-sm text-gray-600 text-center",children:(0,a.jsx)("span",{children:N(e.updatedAt)})})})]},e.id)})})]})})})}var N=s(1211),f=s(2663),v=s(3862),E=s(6283),j=s(8155),b=s(3250);let R=e=>{let{active:t,payload:s}=e;if(t&&s&&s.length){let e=s[0];return(0,a.jsx)("div",{className:"p-3 bg-white/90 backdrop-blur-sm shadow-lg rounded-lg border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{style:{width:12,height:12,backgroundColor:e.payload.color,marginRight:8,borderRadius:"50%"}}),(0,a.jsx)("p",{className:"text-sm text-gray-700",children:"".concat(e.name,": ").concat(e.value)})]})})}return null},I={[h.n$.PENDING_REVIEW]:"#0088FE",[h.n$.PENDING_CM_APPROVAL]:"#00C49F",[h.n$.REVISION_REQUIRED]:"#FFBB28",[h.n$.APPROVED]:"#28A745",[h.n$.REJECTED]:"#DC3545",[h.n$.APPROVED_WITH_COMMENTS]:"#20C997",[h.n$.APPROVED_REVISION_REQUIRED]:"#FD7E14"},A=["#0088FE","#00C49F","#FFBB28","#FF8042","#AF19FF","#FF6363","#BC5090"],P=e=>{let t=0;for(let s=0;s<e.length;s++)t=e.charCodeAt(s)+((t<<5)-t);let s=Math.abs(t%A.length);return A[s]};var w=e=>{let{allDocuments:t,onChartFilter:s,activeFilters:l,categories:n}=e,[i,c]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=()=>c(window.innerWidth<768);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let d=(0,r.useMemo)(()=>{let e={responsibleParty:{BIM:0,SITE:0,CM:0,APPROVED:0,REJECTED:0},categories:{}};for(let a of t){var s;switch(a.status){case h.n$.PENDING_REVIEW:e.responsibleParty.SITE+=1;break;case h.n$.PENDING_CM_APPROVAL:e.responsibleParty.CM+=1;break;case h.n$.REVISION_REQUIRED:case h.n$.APPROVED_REVISION_REQUIRED:e.responsibleParty.BIM+=1;break;case h.n$.REJECTED:e.responsibleParty.REJECTED+=1;break;case h.n$.APPROVED:case h.n$.APPROVED_WITH_COMMENTS:e.responsibleParty.APPROVED+=1}let t=(null===(s=a.category)||void 0===s?void 0:s.id)||"N/A";"N/A"!==t&&(e.categories[t]=(e.categories[t]||0)+1)}return e},[t]),o=(0,r.useMemo)(()=>d?[{name:h.NK[h.n$.PENDING_REVIEW],value:d.responsibleParty.SITE,statusKey:h.n$.PENDING_REVIEW,color:I[h.n$.PENDING_REVIEW]},{name:h.NK[h.n$.PENDING_CM_APPROVAL],value:d.responsibleParty.CM,statusKey:h.n$.PENDING_CM_APPROVAL,color:I[h.n$.PENDING_CM_APPROVAL]},{name:h.NK[h.n$.REVISION_REQUIRED],value:d.responsibleParty.BIM,statusKey:h.n$.REVISION_REQUIRED,color:I[h.n$.REVISION_REQUIRED]},{name:h.NK[h.n$.APPROVED],value:d.responsibleParty.APPROVED,statusKey:h.n$.APPROVED,color:I[h.n$.APPROVED]},{name:h.NK[h.n$.REJECTED],value:d.responsibleParty.REJECTED,statusKey:h.n$.REJECTED,color:I[h.n$.REJECTED]}].filter(e=>e.value>0):[],[d]),x=(0,r.useMemo)(()=>d?Object.entries(d.categories).map(e=>{let[t,s]=e,a=n.find(e=>e.id===t);return{id:t,name:(null==a?void 0:a.categoryCode)||t,value:s,color:P((null==a?void 0:a.categoryCode)||t)}}).filter(e=>e.value>0):[],[d,n]),{displayData:u,total:m}=(0,r.useMemo)(()=>{let e=o.reduce((e,t)=>e+t.value,0);return{displayData:o,total:e}},[o]),{displayData:p,total:y}=(0,r.useMemo)(()=>{let e=x.reduce((e,t)=>e+t.value,0);return{displayData:x,total:e}},[x]);if(!d)return(0,a.jsx)("div",{className:"text-center p-8 text-gray-500",children:"ไม่มีข้อมูลสำหรับแสดงผล"});let g=i?"50%":"40%",A=i?"50%":"30%",w=i?"45%":"50%";return(0,a.jsxs)("div",{className:"relative grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 text-center",children:"สถานะตามผู้รับผิดชอบ"}),(0,a.jsxs)("div",{className:"relative w-full h-[300px]",children:[(0,a.jsx)(N.h,{children:(0,a.jsxs)(f.u,{children:[(0,a.jsx)(v.b,{data:u,cx:g,cy:"50%",innerRadius:i?80:115,outerRadius:i?110:150,dataKey:"value",nameKey:"name",onClick:e=>{let t=e.payload.statusKey;s("status",l.status===t?"ALL":t)},className:"cursor-pointer",isAnimationActive:!1,children:u.map(e=>(0,a.jsx)(E.b,{fill:e.color,style:{opacity:"ALL"===l.status||l.status===e.statusKey?1:.3}},"cell-".concat(e.name)))}),(0,a.jsx)(j.u,{content:(0,a.jsx)(R,{})}),(0,a.jsx)(b.D,{layout:i?"horizontal":"vertical",verticalAlign:i?"bottom":"middle",align:i?"center":"right",wrapperStyle:i?{paddingTop:"20px"}:{},width:i?void 0:150})]})}),(0,a.jsxs)("div",{className:"absolute -translate-y-1/2 -translate-x-1/2 flex flex-col items-center justify-center pointer-events-none",style:{top:w,left:A},children:[(0,a.jsx)("span",{className:"text-base text-gray-500",children:"จำนวนเอกสาร"}),(0,a.jsx)("span",{className:"text-4xl font-bold text-gray-800 mt-1",children:m})]})]})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 text-center",children:"สถานะตามหมวดหมู่"}),(0,a.jsxs)("div",{className:"relative w-full h-[300px]",children:[(0,a.jsx)(N.h,{children:(0,a.jsxs)(f.u,{children:[(0,a.jsx)(v.b,{data:p,cx:g,cy:"50%",innerRadius:i?80:115,outerRadius:i?110:150,dataKey:"value",nameKey:"name",onClick:e=>{let t=e.payload.id;s("categoryId",l.categoryId===t?"ALL":t)},className:"cursor-pointer",isAnimationActive:!1,children:p.map(e=>(0,a.jsx)(E.b,{fill:e.color,style:{opacity:"ALL"===l.categoryId||l.categoryId===e.id?1:.3}},"cell-".concat(e.name)))}),(0,a.jsx)(j.u,{content:(0,a.jsx)(R,{})}),(0,a.jsx)(b.D,{layout:i?"horizontal":"vertical",verticalAlign:i?"bottom":"middle",align:i?"center":"right",wrapperStyle:i?{paddingTop:"20px"}:{},width:i?void 0:150})]})}),(0,a.jsxs)("div",{className:"absolute -translate-y-1/2 -translate-x-1/2 flex flex-col items-center justify-center pointer-events-none",style:{top:w,left:A},children:[(0,a.jsx)("span",{className:"text-base text-gray-500",children:"จำนวนเอกสาร"}),(0,a.jsx)("span",{className:"text-4xl font-bold text-gray-800 mt-1",children:y})]})]})]})})]})},D=s(3900),C=s(7168),L=s(9397),_=s(3247),V=s(6855),O=s(5978);let $={"RFA-SHOP":"Shop Drawing","RFA-GEN":"General","RFA-MAT":"Material"};function S(){let{user:e,firebaseUser:t}=(0,n.a)(),s=(0,l.useRouter)(),d=(0,l.useSearchParams)(),[o,x]=(0,r.useState)([]),[u,m]=(0,r.useState)(!0),[p,y]=(0,r.useState)(null),[N,f]=(0,r.useState)(""),[v,E]=(0,r.useState)([]),[j,b]=(0,r.useState)(!1),[R,I]=(0,r.useState)({rfaType:d.get("type")||"ALL",status:"ALL",siteId:"ALL",showAllRevisions:!1,categoryId:"ALL",responsibleParty:"ALL"}),A=(0,r.useMemo)(()=>{let t=Object.values(h.n$);if(e&&h.gf.includes(e.role)){let e=[h.n$.PENDING_REVIEW,h.n$.REVISION_REQUIRED];return t.filter(t=>!e.includes(t))}return t},[e]),P=(0,r.useMemo)(()=>e&&h.gf.includes(e.role)?[{value:"ALL",label:"ทุกคน"},{value:"CM",label:"CM"}]:[{value:"ALL",label:"ทุกคน"},...h.uc.map(e=>({value:e,label:e})),{value:"SITE",label:"Site"},{value:"CM",label:"CM"}],[e]);(0,r.useEffect)(()=>{let e=d.get("type")||"ALL";e!==R.rfaType&&M("rfaType",e)},[d,R.rfaType]),(0,r.useEffect)(()=>{if(!t||!(null==e?void 0:e.sites)||0===e.sites.length){m(!1);return}m(!0);let s=(0,O.IO)((0,O.hJ)(V.db,"rfaDocuments"),(0,O.ar)("siteId","in",e.sites),(0,O.Xo)("updatedAt","desc")),a=(0,O.cf)(s,e=>{let t=[];e.forEach(e=>{var s,a,r,l,n;let i=e.data();t.push({id:e.id,...i,site:{id:i.siteId,name:i.siteName||"N/A"},category:{id:i.categoryId,categoryCode:(null===(s=i.taskData)||void 0===s?void 0:s.taskCategory)||i.categoryId||"N/A",categoryName:""},createdByInfo:{email:(null===(r=i.workflow)||void 0===r?void 0:null===(a=r[0])||void 0===a?void 0:a.userName)||"N/A",role:(null===(n=i.workflow)||void 0===n?void 0:null===(l=n[0])||void 0===l?void 0:l.role)||"N/A"},permissions:{}})}),x(t),m(!1)},e=>{console.error("Error fetching realtime documents:",e),m(!1)});return()=>a()},[t,e]);let S=(0,r.useMemo)(()=>{let t;let s=e&&h.gf.includes(e.role),a=[h.n$.PENDING_REVIEW,h.n$.REVISION_REQUIRED];if(R.showAllRevisions)t=o;else{let e=new Map;o.forEach(t=>{let s=t.parentRfaId||t.id;e.has(s)||e.set(s,[]),e.get(s).push(t)});let r=[];e.forEach(e=>{if(0===e.length)return;e.sort((e,t)=>(t.revisionNumber||0)-(e.revisionNumber||0));let t=e[0];if(s){if(t&&!a.includes(t.status))r.push(t);else{let t=e.find(e=>!a.includes(e.status));t&&r.push(t)}}else r.push(t)}),t=r}if(s&&(t=t.filter(e=>!a.includes(e.status))),"ALL"!==R.rfaType&&(t=t.filter(e=>e.rfaType===R.rfaType)),"ALL"!==R.status&&(t=t.filter(e=>e.status===R.status)),"ALL"!==R.categoryId&&(t=t.filter(e=>{var t;return(null===(t=e.category)||void 0===t?void 0:t.id)===R.categoryId})),"ALL"!==R.responsibleParty&&(t=t.filter(e=>{var t;let s=R.responsibleParty,a=e.status,r=null===(t=e.createdByInfo)||void 0===t?void 0:t.role;if("SITE"===s)return a===h.n$.PENDING_REVIEW;if("CM"===s)return a===h.n$.PENDING_CM_APPROVAL;if(r&&h.uc.includes(r)){let t=a===h.n$.REVISION_REQUIRED||a===h.n$.APPROVED_REVISION_REQUIRED,l=a===h.n$.REJECTED&&e.isLatest;return(t||l)&&r===s}return!1})),N.trim()){let e=N.toLowerCase();t=t.filter(t=>t.documentNumber.toLowerCase().includes(e)||t.title.toLowerCase().includes(e))}return t},[o,R,e,N]),T=async()=>{if(t)try{let e=await t.getIdToken(),s=await fetch("/api/rfa/categories?rfaType=ALL",{headers:{Authorization:"Bearer ".concat(e)}}),a=await s.json();if(a.success){let e=Array.from(new Map(a.categories.map(e=>[e.id,e])).values());E(e)}}catch(e){console.error("Failed to load categories:",e)}};(0,r.useEffect)(()=>{t&&T()},[t]);let M=(e,t)=>{I(s=>({...s,[e]:t}))};return e?(0,a.jsx)(i.a1,{children:(0,a.jsx)(c.Z,{children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:["\uD83D\uDCCB RFA Documents",R.rfaType&&"ALL"!==R.rfaType&&(0,a.jsxs)("span",{className:"text-orange-600",children:[" - ",$[R.rfaType]]})]}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"จัดการเอกสาร Request for Approval"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3 mt-4 sm:mt-0",children:[(0,a.jsxs)("button",{onClick:()=>{},className:"flex items-center px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",disabled:u,children:[(0,a.jsx)(C.Z,{className:"w-4 h-4 mr-2 ".concat(u?"animate-spin":"")}),u?"Syncing...":"Real-time"]}),(0,a.jsxs)("button",{onClick:()=>{b(!0)},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,a.jsx)(L.Z,{className:"w-4 h-4 mr-2"}),"สร้าง RFA"]})]})]}),(0,a.jsx)(w,{allDocuments:S,onChartFilter:(e,t)=>{I(s=>({...s,[e]:t}))},activeFilters:R,categories:v}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow mb-6 p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-end",children:[(0,a.jsxs)("div",{className:"md:col-span-3",children:[(0,a.jsx)("label",{htmlFor:"search-filter",className:"text-sm font-medium text-gray-700",children:"ค้นหา"}),(0,a.jsxs)("div",{className:"relative mt-1",children:[(0,a.jsx)(_.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)("input",{id:"search-filter",type:"text",placeholder:"เลขที่เอกสาร, ชื่อเอกสาร...",value:N,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{htmlFor:"status-filter",className:"text-sm font-medium text-gray-700",children:"สถานะ"}),(0,a.jsxs)("select",{id:"status-filter",value:R.status,onChange:e=>M("status",e.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-lg",children:[(0,a.jsx)("option",{value:"ALL",children:"ทุกสถานะ"}),A.map(e=>(0,a.jsx)("option",{value:e,children:h.NK[e]||e},e))]})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{htmlFor:"responsible-party-filter",className:"text-sm font-medium text-gray-700",children:"ผู้รับผิดชอบ"}),(0,a.jsx)("select",{id:"responsible-party-filter",value:R.responsibleParty,onChange:e=>M("responsibleParty",e.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-lg",children:P.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{htmlFor:"category-filter",className:"text-sm font-medium text-gray-700",children:"หมวดงาน"}),(0,a.jsxs)("select",{id:"category-filter",className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-lg",value:R.categoryId,onChange:e=>M("categoryId",e.target.value),children:[(0,a.jsx)("option",{value:"ALL",children:"ทุกหมวดงาน"}),v.map(e=>(0,a.jsx)("option",{value:e.id,children:e.categoryCode},e.id))]})]}),(0,a.jsxs)("div",{className:"md:col-span-1 flex items-center h-10",children:[(0,a.jsx)("input",{id:"show-all-revisions",type:"checkbox",checked:R.showAllRevisions,onChange:e=>M("showAllRevisions",e.target.checked),className:"h-4 w-4 rounded border-gray-300 text-blue-600"}),(0,a.jsx)("label",{htmlFor:"show-all-revisions",className:"ml-2 text-sm text-gray-700",children:"ทุกฉบับ"})]}),(0,a.jsx)("div",{className:"md:col-span-2",children:(0,a.jsx)("button",{onClick:()=>{I({rfaType:R.rfaType,status:"ALL",siteId:"ALL",showAllRevisions:!1,categoryId:"ALL",responsibleParty:"ALL"}),f("")},className:"w-full px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"รีเซ็ต"})})]})}),u?(0,a.jsx)("div",{className:"text-center p-8",children:"กำลังโหลดเอกสาร..."}):0===S.length?(0,a.jsx)("div",{className:"text-center bg-white rounded-lg shadow p-8",children:(0,a.jsx)("p",{className:"text-gray-500",children:"ไม่พบเอกสารที่ตรงกับเงื่อนไข"})}):(0,a.jsx)(g,{documents:S,onDocumentClick:e=>s.push("/rfa/".concat(e.id)),getStatusColor:e=>{switch(e){case h.n$.APPROVED:case h.n$.APPROVED_WITH_COMMENTS:case h.n$.APPROVED_REVISION_REQUIRED:return"text-green-600 bg-green-50";case h.n$.REJECTED:return"text-red-600 bg-red-50";case h.n$.PENDING_CM_APPROVAL:return"text-orange-600 bg-orange-50";case h.n$.PENDING_REVIEW:return"text-blue-600 bg-blue-50";case h.n$.REVISION_REQUIRED:return"text-yellow-600 bg-yellow-50";default:return"text-gray-600 bg-gray-50"}},statusLabels:h.NK,getRFATypeColor:e=>{switch(e){case"RFA-SHOP":return"bg-blue-100 text-blue-800";case"RFA-GEN":return"bg-green-100 text-green-800";case"RFA-MAT":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}}}),j&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4",children:(0,a.jsx)(D.Z,{onClose:()=>{b(!1)},isModal:!0,userProp:e?{id:e.id,email:e.email,role:e.role,sites:e.sites||[]}:void 0,presetRfaType:"ALL"!==R.rfaType?R.rfaType:void 0})})]})})}):null}function T(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading..."}),children:(0,a.jsx)(S,{})})}}},function(e){e.O(0,[609,15,351,651,120,514,900,971,117,744],function(){return e(e.s=1417)}),_N_E=e.O()}]);