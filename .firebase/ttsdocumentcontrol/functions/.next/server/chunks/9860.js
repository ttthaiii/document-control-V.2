exports.id=9860,exports.ids=[9860],exports.modules={31635:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},30570:(e,t,s)=>{Promise.resolve().then(s.bind(s,26107)),Promise.resolve().then(s.bind(s,4055))},79821:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(10326);s(17577);let a=({className:e})=>{let t=`
    inline-block h-8 w-8 animate-spin rounded-full 
    border-4 border-solid border-current border-e-transparent 
    align-[-0.125em] text-gray-400 motion-reduce:animate-[spin_1.5s_linear_infinite]
    ${e||""}
  `;return r.jsx("div",{className:t.trim(),role:"status",children:r.jsx("span",{className:"!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]",children:"Loading..."})})}},26107:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>c,aC:()=>m});var r=s(10326),a=s(17577),i=s(5779),n=s(76),l=s(67967);let d=null,o=(0,a.createContext)({user:null,firebaseUser:null,loading:!0,error:null,refetch:async()=>{},logout:async()=>{}});function c({children:e}){let[t,s]=(0,a.useState)(null),[c,m]=(0,a.useState)(null),[u,x]=(0,a.useState)(!0),[h,g]=(0,a.useState)(null),b=async e=>{try{if(g(null),d&&d.firebaseUserId===e.uid&&Date.now()-d.timestamp<3e5){console.log(`ðŸ“‹ Using cached user data for: ${e.email}`),m(d.user);return}console.log(`ðŸ”„ Fetching fresh user data for: ${e.email}`);let t=(0,n.JU)(l.db,"users",e.uid),s=await (0,n.QT)(t);if(s.exists()){let t=s.data(),r={id:e.uid,email:e.email||"",role:t.role,sites:t.sites||[],status:t.status||"ACTIVE",createdFromInvitation:t.createdFromInvitation,createdAt:t.createdAt?.toDate(),acceptedAt:t.acceptedAt?.toDate()};d={user:r,timestamp:Date.now(),firebaseUserId:e.uid},m(r)}else g("à¹„à¸¡à¹ˆà¸žà¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¹ƒà¸™à¸£à¸°à¸šà¸š"),m(null)}catch(e){console.error("Error fetching user data:",e),g("à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”à¹ƒà¸™à¸à¸²à¸£à¹‚à¸«à¸¥à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰"),m(null)}},E=async()=>{t&&(d=null,await b(t))},N=async()=>{try{await (0,i.w7)(l.I),d=null,m(null),s(null),g(null)}catch(e){throw console.error("Logout error:",e),e}};return r.jsx(o.Provider,{value:{user:c,firebaseUser:t,loading:u,error:h,refetch:E,logout:N},children:e})}function m(){return(0,a.useContext)(o)}},32875:(e,t,s)=>{"use strict";s.d(t,{AuthGuard:()=>l});var r=s(10326),a=s(26107),i=s(35047);s(17577),s(7619);let n=()=>r.jsx("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"bg-white shadow",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center py-6",children:[r.jsx("div",{className:"h-8 bg-gray-200 rounded w-32"}),r.jsx("div",{className:"h-8 bg-gray-200 rounded w-24"})]})})}),(0,r.jsxs)("div",{className:"flex",children:[r.jsx("div",{className:"w-64 bg-white border-r border-gray-200 min-h-screen",children:r.jsx("div",{className:"p-4 space-y-3",children:[...Array(6)].map((e,t)=>r.jsx("div",{className:"h-10 bg-gray-100 rounded"},t))})}),r.jsx("div",{className:"flex-1 p-8",children:(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),r.jsx("div",{className:"h-8 bg-gray-200 rounded mb-4"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]},t))})]})})]})]})});function l({children:e,requiredRoles:t=[],requiredSiteAccess:s=[],fallback:l,redirectTo:d="/login"}){let{user:o,loading:c,error:m}=(0,a.aC)(),u=(0,i.useRouter)();return c?r.jsx(n,{}):m?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:r.jsx("div",{className:"text-center max-w-md mx-auto",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”"}),r.jsx("p",{className:"text-red-600 mb-4",children:m}),r.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ"})]})})}):o?t.length>0&&!t.includes(o.role)?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:r.jsx("div",{className:"text-center max-w-md mx-auto",children:(0,r.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡"}),r.jsx("p",{className:"text-yellow-700 mb-2",children:"à¸„à¸¸à¸“à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¸«à¸™à¹‰à¸²à¸™à¸µà¹‰"}),(0,r.jsxs)("p",{className:"text-sm text-yellow-600 mb-4",children:["à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸ªà¸´à¸—à¸˜à¸´à¹Œ: ",t.join(", ")," | à¸ªà¸´à¸—à¸˜à¸´à¹Œà¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™: ",o.role]}),r.jsx("button",{onClick:()=>u.back(),className:"bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 transition-colors",children:"à¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸š"})]})})}):s.length>0&&"Admin"!==o.role&&!s.some(e=>o.sites?.includes(e))?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:r.jsx("div",{className:"text-center max-w-md mx-auto",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¹‚à¸„à¸£à¸‡à¸à¸²à¸£"}),r.jsx("p",{className:"text-red-600 mb-4",children:"à¸„à¸¸à¸“à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£"}),r.jsx("button",{onClick:()=>u.back(),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"à¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸š"})]})})}):r.jsx(r.Fragment,{children:e}):l?r.jsx(r.Fragment,{children:l}):r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"à¸à¸£à¸¸à¸“à¸²à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"à¸„à¸¸à¸“à¸•à¹‰à¸­à¸‡à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸šà¹€à¸žà¸·à¹ˆà¸­à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¸«à¸™à¹‰à¸²à¸™à¸µà¹‰"}),r.jsx("button",{onClick:()=>u.push(d),className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition-colors",children:"à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š"})]})})}},7619:(e,t,s)=>{"use strict";s.d(t,{K$:()=>r,NK:()=>d,gf:()=>n,n$:()=>l,oU:()=>i,uc:()=>a,yh:()=>o});let r={ADMIN:"Admin",BIM:"BIM",SITE_ADMIN:"Site Admin",CM:"CM",ME:"ME",SN:"SN",OE:"OE",PE:"PE",PM:"PM",SE:"SE",ADMIN_SITE_2:"Adminsite2"},a=[r.BIM,r.ME,r.SN],i=[r.SITE_ADMIN,r.ADMIN_SITE_2,r.OE,r.PE],n=[r.CM];r.PM,r.SE;let l={PENDING_REVIEW:"PENDING_REVIEW",PENDING_CM_APPROVAL:"PENDING_CM_APPROVAL",REVISION_REQUIRED:"REVISION_REQUIRED",APPROVED:"APPROVED",APPROVED_WITH_COMMENTS:"APPROVED_WITH_COMMENTS",APPROVED_REVISION_REQUIRED:"APPROVED_REVISION_REQUIRED",REJECTED:"REJECTED",PENDING_FINAL_APPROVAL:"PENDING_FINAL_APPROVAL"},d={[l.PENDING_REVIEW]:"à¸£à¸­à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š",[l.PENDING_CM_APPROVAL]:"à¸ªà¹ˆà¸‡ CM",[l.REVISION_REQUIRED]:"à¹à¸à¹‰à¹„à¸‚",[l.APPROVED]:"à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´",[l.APPROVED_WITH_COMMENTS]:"à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸•à¸²à¸¡à¸„à¸­à¸¡à¹€à¸¡à¸™à¸•à¹Œ (à¹„à¸¡à¹ˆà¹à¸à¹‰à¹„à¸‚)",[l.APPROVED_REVISION_REQUIRED]:"à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸•à¸²à¸¡à¸„à¸­à¸¡à¹€à¸¡à¸™à¸•à¹Œ (à¸•à¹‰à¸­à¸‡à¹à¸à¹‰à¹„à¸‚)",[l.REJECTED]:"à¹„à¸¡à¹ˆà¸­à¸™à¸¸à¸¡à¸±à¸•à¸´",[l.PENDING_FINAL_APPROVAL]:"à¸£à¸­ SITE à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸‚à¸±à¹‰à¸™à¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢"},o={[l.PENDING_REVIEW]:"#0088FE",[l.PENDING_CM_APPROVAL]:"#00C49F",[l.REVISION_REQUIRED]:"#FFBB28",[l.APPROVED]:"#28A745",[l.REJECTED]:"#DC3545",[l.APPROVED_WITH_COMMENTS]:"#20C997",[l.APPROVED_REVISION_REQUIRED]:"#FD7E14"}},4055:(e,t,s)=>{"use strict";s.d(t,{LoadingProvider:()=>o,Y:()=>d,r:()=>c});var r=s(10326),a=s(17577),i=s(79821),n=s(35047);let l=(0,a.createContext)(void 0),d=()=>r.jsx("div",{className:"absolute inset-0 bg-gray-100 z-30 flex items-center justify-center",children:r.jsx(i.Z,{className:"w-12 h-12 text-gray-500"})}),o=({children:e})=>{let[t,s]=(0,a.useState)(!1),i=(0,n.usePathname)(),d=(0,n.useSearchParams)();return(0,a.useEffect)(()=>{s(!1)},[i,d]),r.jsx(l.Provider,{value:{isLoading:t,showLoader:()=>s(!0),hideLoader:()=>s(!1)},children:e})},c=()=>{let e=(0,a.useContext)(l);if(void 0===e)throw Error("useLoading must be used within a LoadingProvider");return e}},67967:(e,t,s)=>{"use strict";s.d(t,{I:()=>l,db:()=>d});var r=s(42585),a=s(5779),i=s(76);let n=(0,r.C6)().length>0?(0,r.C6)()[0]:(0,r.ZF)({apiKey:"AIzaSyAsayb-DEOBE0zi0qh-dPBfihClgXrX1sY",authDomain:"ttsdocumentcontrol.firebaseapp.com",projectId:"ttsdocumentcontrol",storageBucket:"ttsdocumentcontrol.firebasestorage.app",messagingSenderId:"48440915675",appId:"1:48440915675:web:f11611895bfb52d4d27efe"}),l=(0,a.v0)(n),d=(0,i.ad)(n)},87666:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d,metadata:()=>l});var r=s(19510);s(5023);var a=s(68570);let i=(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\auth\useAuth.tsx#AuthProvider`);(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\auth\useAuth.tsx#clearUserCache`),(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\auth\useAuth.tsx#getCacheInfo`),(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\auth\useAuth.tsx#useAuth`),(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\context\LoadingContext.tsx#GlobalSpinner`);let n=(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\context\LoadingContext.tsx#LoadingProvider`);(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\context\LoadingContext.tsx#useLoading`);let l={title:"ttsdoc v2 - Construction Document Management",description:"Professional construction document management system"};function d({children:e}){return r.jsx("html",{lang:"th",children:r.jsx("body",{children:r.jsx(i,{children:(0,r.jsxs)(n,{children:[" ",e]})})})})}},73881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(66621);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};