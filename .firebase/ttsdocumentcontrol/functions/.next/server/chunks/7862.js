exports.id=7862,exports.ids=[7862],exports.modules={31635:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},95744:(e,t,s)=>{Promise.resolve().then(s.bind(s,26107)),Promise.resolve().then(s.bind(s,4055)),Promise.resolve().then(s.bind(s,31469))},79821:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var r=s(10326);s(17577);let i=({className:e})=>{let t=`
    inline-block h-8 w-8 animate-spin rounded-full 
    border-4 border-solid border-current border-e-transparent 
    align-[-0.125em] text-gray-400 motion-reduce:animate-[spin_1.5s_linear_infinite]
    ${e||""}
  `;return r.jsx("div",{className:t.trim(),role:"status",children:r.jsx("span",{className:"!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]",children:"Loading..."})})}},26107:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>d,aC:()=>x});var r=s(10326),i=s(17577),a=s(5779),n=s(76),l=s(67967);let o=null,c=(0,i.createContext)({user:null,firebaseUser:null,loading:!0,error:null,refetch:async()=>{},logout:async()=>{}});function d({children:e}){let[t,s]=(0,i.useState)(null),[d,x]=(0,i.useState)(null),[u,m]=(0,i.useState)(!0),[E,h]=(0,i.useState)(null),N=async e=>{try{if(h(null),o&&o.firebaseUserId===e.uid&&Date.now()-o.timestamp<3e5){console.log(`ðŸ“‹ Using cached user data for: ${e.email}`),x(o.user);return}console.log(`ðŸ”„ Fetching fresh user data for: ${e.email}`);let t=(0,n.JU)(l.db,"users",e.uid),s=await (0,n.QT)(t);if(s.exists()){let t=s.data(),r={id:e.uid,email:e.email||"",role:t.role,sites:t.sites||[],status:t.status||"ACTIVE",createdFromInvitation:t.createdFromInvitation,createdAt:t.createdAt?.toDate(),acceptedAt:t.acceptedAt?.toDate()};o={user:r,timestamp:Date.now(),firebaseUserId:e.uid},x(r)}else h("à¹„à¸¡à¹ˆà¸žà¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¹ƒà¸™à¸£à¸°à¸šà¸š"),x(null)}catch(e){console.error("Error fetching user data:",e),h("à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”à¹ƒà¸™à¸à¸²à¸£à¹‚à¸«à¸¥à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰"),x(null)}},g=async()=>{t&&(o=null,await N(t))},b=async()=>{try{await (0,a.w7)(l.I),o=null,x(null),s(null),h(null)}catch(e){throw console.error("Logout error:",e),e}};return r.jsx(c.Provider,{value:{user:d,firebaseUser:t,loading:u,error:E,refetch:g,logout:b},children:e})}function x(){return(0,i.useContext)(c)}},32875:(e,t,s)=>{"use strict";s.d(t,{AuthGuard:()=>l});var r=s(10326),i=s(26107),a=s(35047);s(17577),s(7619);let n=()=>r.jsx("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"bg-white shadow",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center py-6",children:[r.jsx("div",{className:"h-8 bg-gray-200 rounded w-32"}),r.jsx("div",{className:"h-8 bg-gray-200 rounded w-24"})]})})}),(0,r.jsxs)("div",{className:"flex",children:[r.jsx("div",{className:"w-64 bg-white border-r border-gray-200 min-h-screen",children:r.jsx("div",{className:"p-4 space-y-3",children:[...Array(6)].map((e,t)=>r.jsx("div",{className:"h-10 bg-gray-100 rounded"},t))})}),r.jsx("div",{className:"flex-1 p-8",children:(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),r.jsx("div",{className:"h-8 bg-gray-200 rounded mb-4"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]},t))})]})})]})]})});function l({children:e,requiredRoles:t=[],requiredSiteAccess:s=[],fallback:l,redirectTo:o="/login"}){let{user:c,loading:d,error:x}=(0,i.aC)(),u=(0,a.useRouter)();return d?r.jsx(n,{}):x?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:r.jsx("div",{className:"text-center max-w-md mx-auto",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”"}),r.jsx("p",{className:"text-red-600 mb-4",children:x}),r.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ"})]})})}):c?t.length>0&&!t.includes(c.role)?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:r.jsx("div",{className:"text-center max-w-md mx-auto",children:(0,r.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡"}),r.jsx("p",{className:"text-yellow-700 mb-2",children:"à¸„à¸¸à¸“à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¸«à¸™à¹‰à¸²à¸™à¸µà¹‰"}),(0,r.jsxs)("p",{className:"text-sm text-yellow-600 mb-4",children:["à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸ªà¸´à¸—à¸˜à¸´à¹Œ: ",t.join(", ")," | à¸ªà¸´à¸—à¸˜à¸´à¹Œà¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™: ",c.role]}),r.jsx("button",{onClick:()=>u.back(),className:"bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 transition-colors",children:"à¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸š"})]})})}):s.length>0&&"Admin"!==c.role&&!s.some(e=>c.sites?.includes(e))?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:r.jsx("div",{className:"text-center max-w-md mx-auto",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¹‚à¸„à¸£à¸‡à¸à¸²à¸£"}),r.jsx("p",{className:"text-red-600 mb-4",children:"à¸„à¸¸à¸“à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£"}),r.jsx("button",{onClick:()=>u.back(),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"à¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸š"})]})})}):r.jsx(r.Fragment,{children:e}):l?r.jsx(r.Fragment,{children:l}):r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"à¸à¸£à¸¸à¸“à¸²à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"à¸„à¸¸à¸“à¸•à¹‰à¸­à¸‡à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸šà¹€à¸žà¸·à¹ˆà¸­à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¸«à¸™à¹‰à¸²à¸™à¸µà¹‰"}),r.jsx("button",{onClick:()=>u.push(o),className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition-colors",children:"à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š"})]})})}},7619:(e,t,s)=>{"use strict";s.d(t,{$p:()=>o,Ge:()=>d,K$:()=>r,NK:()=>x,c9:()=>l,gf:()=>n,n$:()=>c,oU:()=>a,uc:()=>i,yh:()=>u});let r={ADMIN:"Admin",BIM:"BIM",SITE_ADMIN:"Site Admin",CM:"CM",ME:"ME",SN:"SN",OE:"OE",PE:"PE",PM:"PM",PD:"PD",SE:"SE",ADMIN_SITE_2:"Adminsite2"},i=[r.BIM,r.ME,r.SN],a=[r.SITE_ADMIN,r.ADMIN_SITE_2,r.OE,r.PE],n=[r.CM,r.PD];r.PM,r.SE;let l=[r.PE,r.OE,r.ADMIN],o=[r.PD,r.PM,r.ADMIN],c={PENDING_REVIEW:"PENDING_REVIEW",PENDING_CM_APPROVAL:"PENDING_CM_APPROVAL",REVISION_REQUIRED:"REVISION_REQUIRED",APPROVED:"APPROVED",APPROVED_WITH_COMMENTS:"APPROVED_WITH_COMMENTS",APPROVED_REVISION_REQUIRED:"APPROVED_REVISION_REQUIRED",REJECTED:"REJECTED",PENDING_FINAL_APPROVAL:"PENDING_FINAL_APPROVAL"},d={DRAFT:"DRAFT",REJECTED_BY_PM:"REJECTED_BY_PM",PENDING_BIM:"PENDING_BIM",IN_PROGRESS:"IN_PROGRESS",PENDING_ACCEPTANCE:"PENDING_ACCEPTANCE",REVISION_REQUESTED:"REVISION_REQUESTED",COMPLETED:"COMPLETED"},x={[c.PENDING_REVIEW]:"à¸£à¸­à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š",[c.PENDING_CM_APPROVAL]:"à¸ªà¹ˆà¸‡ CM",[c.REVISION_REQUIRED]:"à¹à¸à¹‰à¹„à¸‚",[c.APPROVED]:"à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´",[c.APPROVED_WITH_COMMENTS]:"à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸•à¸²à¸¡à¸„à¸­à¸¡à¹€à¸¡à¸™à¸•à¹Œ (à¹„à¸¡à¹ˆà¹à¸à¹‰à¹„à¸‚)",[c.APPROVED_REVISION_REQUIRED]:"à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸•à¸²à¸¡à¸„à¸­à¸¡à¹€à¸¡à¸™à¸•à¹Œ (à¸•à¹‰à¸­à¸‡à¹à¸à¹‰à¹„à¸‚)",[c.REJECTED]:"à¹„à¸¡à¹ˆà¸­à¸™à¸¸à¸¡à¸±à¸•à¸´",[c.PENDING_FINAL_APPROVAL]:"à¸£à¸­ SITE à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸‚à¸±à¹‰à¸™à¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢",[d.DRAFT]:"à¸£à¸­à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´ (PM)",[d.REJECTED_BY_PM]:"à¹„à¸¡à¹ˆà¸­à¸™à¸¸à¸¡à¸±à¸•à¸´ (PM)",[d.PENDING_BIM]:"à¸£à¸­ BIM à¸£à¸±à¸šà¸‡à¸²à¸™",[d.IN_PROGRESS]:"BIM à¸à¸³à¸¥à¸±à¸‡à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£",[d.PENDING_ACCEPTANCE]:"à¸£à¸­à¸•à¸£à¸§à¸ˆà¸£à¸±à¸š (Site)",[d.REVISION_REQUESTED]:"à¸‚à¸­à¹à¸à¹‰à¹„à¸‚ (WR)",[d.COMPLETED]:"à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™"},u={[c.PENDING_REVIEW]:"#0088FE",[c.PENDING_CM_APPROVAL]:"#00C49F",[c.REVISION_REQUIRED]:"#FFBB28",[c.APPROVED]:"#28A745",[c.REJECTED]:"#DC3545",[c.APPROVED_WITH_COMMENTS]:"#2f3e3aff",[c.APPROVED_REVISION_REQUIRED]:"#FD7E14",[d.DRAFT]:"#6c757d",[d.REJECTED_BY_PM]:"#DC3545",[d.PENDING_BIM]:"#0088FE",[d.IN_PROGRESS]:"#FFBB28",[d.PENDING_ACCEPTANCE]:"#AF19FF",[d.REVISION_REQUESTED]:"#FD7E14",[d.COMPLETED]:"#28A745"}},4055:(e,t,s)=>{"use strict";s.d(t,{LoadingProvider:()=>c,Y:()=>o,r:()=>d});var r=s(10326),i=s(17577),a=s(79821),n=s(35047);let l=(0,i.createContext)(void 0),o=()=>r.jsx("div",{className:"absolute inset-0 bg-gray-100 z-30 flex items-center justify-center",children:r.jsx(a.Z,{className:"w-12 h-12 text-gray-500"})}),c=({children:e})=>{let[t,s]=(0,i.useState)(!1),a=(0,n.usePathname)(),o=(0,n.useSearchParams)();return(0,i.useEffect)(()=>{s(!1)},[a,o]),r.jsx(l.Provider,{value:{isLoading:t,showLoader:()=>s(!0),hideLoader:()=>s(!1)},children:e})},d=()=>{let e=(0,i.useContext)(l);if(void 0===e)throw Error("useLoading must be used within a LoadingProvider");return e}},31469:(e,t,s)=>{"use strict";s.d(t,{NotificationProvider:()=>u,l:()=>m});var r=s(10326),i=s(17577),a=s(30361),n=s(69669),l=s(50949);let o={success:r.jsx(a.Z,{className:"h-12 w-12 text-green-500"}),error:r.jsx(n.Z,{className:"h-12 w-12 text-red-500"}),warning:r.jsx(l.Z,{className:"h-12 w-12 text-yellow-500"})},c={success:"bg-green-600 hover:bg-green-700",error:"bg-red-600 hover:bg-red-700",warning:"bg-yellow-600 hover:bg-yellow-700"},d=({isOpen:e,type:t,title:s,message:i,onClose:a})=>e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-[100] flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl w-full max-w-sm mx-auto p-6 text-center",children:[r.jsx("div",{className:"flex justify-center mb-4",children:o[t]}),r.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:s}),i&&r.jsx("p",{className:"text-gray-600 text-sm mb-6 whitespace-pre-wrap",children:i}),r.jsx("button",{onClick:a,className:`w-full px-4 py-2 text-white font-semibold rounded-lg transition-colors ${c[t]}`,children:"à¸•à¸à¸¥à¸‡"})]})}):null,x=(0,i.createContext)(void 0),u=({children:e})=>{let[t,s]=(0,i.useState)({isOpen:!1,type:"success",title:"",message:null}),a=(0,i.useCallback)((e,t,r="")=>{s({isOpen:!0,type:e,title:t,message:r})},[]);return(0,r.jsxs)(x.Provider,{value:{showNotification:a},children:[e,r.jsx(d,{isOpen:t.isOpen,type:t.type,title:t.title,message:t.message,onClose:()=>{s(e=>({...e,isOpen:!1}))}})]})},m=()=>{let e=(0,i.useContext)(x);if(void 0===e)throw Error("useNotification must be used within a NotificationProvider");return e}},67967:(e,t,s)=>{"use strict";s.d(t,{I:()=>l,db:()=>o});var r=s(42585),i=s(5779),a=s(76);let n=(0,r.C6)().length>0?(0,r.C6)()[0]:(0,r.ZF)({apiKey:"AIzaSyAsayb-DEOBE0zi0qh-dPBfihClgXrX1sY",authDomain:"ttsdocumentcontrol.firebaseapp.com",projectId:"ttsdocumentcontrol",storageBucket:"ttsdocumentcontrol.firebasestorage.app",messagingSenderId:"48440915675",appId:"1:48440915675:web:f11611895bfb52d4d27efe"}),l=(0,i.v0)(n),o=(0,a.ad)(n);try{(0,a.ST)(o).then(()=>{console.log("âœ… Firestore offline persistence enabled.")}).catch(e=>{"failed-precondition"==e.code?console.warn("Firestore persistence failed: Multiple tabs open. Persistence will be enabled in one tab only."):"unimplemented"==e.code&&console.warn("Firestore persistence is not supported in this browser.")})}catch(e){console.error("An error occurred while enabling Firestore persistence:",e)}},96868:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c,metadata:()=>o});var r=s(19510);s(5023);var i=s(68570);let a=(0,i.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\auth\useAuth.tsx#AuthProvider`);(0,i.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\auth\useAuth.tsx#clearUserCache`),(0,i.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\auth\useAuth.tsx#getCacheInfo`),(0,i.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\auth\useAuth.tsx#useAuth`),(0,i.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\context\LoadingContext.tsx#GlobalSpinner`);let n=(0,i.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\context\LoadingContext.tsx#LoadingProvider`);(0,i.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\context\LoadingContext.tsx#useLoading`);let l=(0,i.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\context\NotificationContext.tsx#NotificationProvider`);(0,i.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\context\NotificationContext.tsx#useNotification`);let o={title:"ttsdoc v2 - Construction Document Management",description:"Professional construction document management system"};function c({children:e}){return r.jsx("html",{lang:"th",children:r.jsx("body",{children:r.jsx(a,{children:r.jsx(n,{children:(0,r.jsxs)(l,{children:[" ",e]})})})})})}},73881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(66621);let i=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};