exports.id=3431,exports.ids=[3431],exports.modules={14669:(e,t,s)=>{Promise.resolve().then(s.bind(s,7022))},7022:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(10326),n=s(17577),a=s(28882);function i({children:e}){return r.jsx(n.Suspense,{fallback:r.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}),children:r.jsx(a.Z,{children:e})})}},31539:(e,t,s)=>{"use strict";s.d(t,{Z:()=>S});var r=s(10326),n=s(17577),a=s(90748),i=s(82685),l=s(69669),o=s(77506),c=s(31215),d=s(94019),u=s(56931),h=s(9073),g=s(61182),x=s(92939),m=s(21608),p=s(53982),f=s(23133),b=s(98091),w=s(11019),v=s(83855),j=s(2634),y=s(11890),N=s(39183),C=s(73865);const k=["#000000","#DC2626","#2563EB","#16A34A","#EA580C"];function S({isOpen:e,file:t,onClose:S,onSave:Z,allowEdit:R=!0}){const P=(0,n.useRef)(null),z=(0,n.useRef)(null),A=(0,n.useRef)(null),D=(0,n.useRef)(null),F=(0,n.useRef)({}),M=((0,n.useRef)(!1),(0,n.useRef)(1)),O=((0,n.useRef)(null),(0,n.useRef)(1)),[E,L]=((0,n.useRef)(0),(0,n.useState)(!1)),[T,W]=(0,n.useState)("hand"),[q,J]=(0,n.useState)("#DC2626"),[X,Y]=(0,n.useState)(3),[B,H]=(0,n.useState)(1),[I,U]=(0,n.useState)(0),[V,$]=(0,n.useState)(1),[_,G]=(0,n.useState)(1),[K,Q]=(0,n.useState)({width:0,height:0}),[ee,te]=(0,n.useState)(!1),[se,re]=(0,n.useState)(!1),[ne,ae]=(0,n.useState)(!0),[ie,le]=(0,n.useState)({}),[oe,ce]=(0,n.useState)(!1),de=((0,n.useRef)(!1),(0,n.useRef)(0),(0,n.useRef)(1),(0,n.useCallback)((()=>{if(!R||!A.current)return;const e=A.current,t=M.current,s=e.getZoom(),{width:r,height:n}=e;e.setViewportTransform([1,0,0,1,0,0]),e.setWidth(r/s),e.setHeight(n/s),F.current[t]=e.toJSON(),e.setZoom(s),e.setWidth(r),e.setHeight(n)}),[R])),ue=(0,n.useCallback)(((e,t,s)=>{de();const r=z.current;if(!r||!K.width)return;const n=Math.min(Math.max(.5,e),5),a=O.current;O.current=n,$(n);const i=r.getBoundingClientRect(),l=i.width,o=i.height,c=void 0!==t?t-i.left:l/2,d=void 0!==s?s-i.top:o/2,u=(r.scrollLeft+c)/a,h=(r.scrollTop+d)/a,g=u*n-c,x=h*n-d;requestAnimationFrame((()=>{r&&(r.scrollLeft=Math.max(0,g),r.scrollTop=Math.max(0,x))}))}),[K,de]),he=e=>{e<1||e>I||(de(),H(e),z.current&&(z.current.scrollLeft=0,z.current.scrollTop=0))};(0,n.useCallback)((e=>{if(!e)return;e.off("mouse:down"),e.off("mouse:move"),e.off("mouse:up"),e.off("path:created"),e.isDrawingMode=!1,e.selection=!1,e.defaultCursor="default",e.skipTargetFind=!1;const t=e.upperCanvasEl;t&&(t.style.touchAction="none"),e.on("path:created",(t=>{t.path&&"destination-out"===t.path.globalCompositeOperation&&(t.path.set({selectable:!1,evented:!1}),e.discardActiveObject(),e.requestRenderAll())}));const s=E?T:"hand";if("hand"===s){e.defaultCursor="grab",e.skipTargetFind=!0,e.selection=!1,e.discardActiveObject(),e.requestRenderAll();let t=!1,s=0,r=0;e.on("mouse:down",(n=>{const a=n.e;t=!0,e.setCursor("grabbing"),"touchstart"===a.type&&a.touches&&a.touches.length>0?(s=a.touches[0].clientX,r=a.touches[0].clientY):(s=a.clientX,r=a.clientY),a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation()})),e.on("mouse:move",(e=>{if(!t)return;const n=e.e;if(n.touches&&n.touches.length>1)return;let a,i;"touchmove"===n.type&&n.touches&&n.touches.length>0?(a=n.touches[0].clientX,i=n.touches[0].clientY):(a=n.clientX,i=n.clientY);const l=a-s,o=i-r;z.current&&(z.current.scrollLeft-=l,z.current.scrollTop-=o),s=a,r=i,n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation()})),e.on("mouse:up",(()=>{t&&(t=!1,e.setCursor("grab"))}))}else if(["select","draw","eraser","text","rect","circle"].includes(s))if("select"===s)e.selection=!0,e.defaultCursor="default";else if("draw"===s){e.isDrawingMode=!0;const t=new C.pJ(e);t.width=X,t.color=q,e.freeDrawingBrush=t}else if("eraser"===s){e.isDrawingMode=!0;const t=new C.pJ(e);t.width=5*X,t.color="white",t.createPath=function(e){const t=C.pJ.prototype.createPath.call(this,e);return t.globalCompositeOperation="destination-out",t},e.freeDrawingBrush=t}else if("text"===s)e.defaultCursor="text",e.on("mouse:down",(t=>{if(t.target)return;const s=e.getScenePoint(t.e),r=new C.aW("\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21",{left:s.x,top:s.y,fontFamily:"Arial",fill:q,fontSize:24/V});e.add(r),e.setActiveObject(r),r.enterEditing(),W("select")}));else if(["rect","circle"].includes(s)){e.defaultCursor="crosshair";let t=null,r=!1,n=0,a=0;e.on("mouse:down",(i=>{if(i.target)return;r=!0;const l=e.getScenePoint(i.e);n=l.x,a=l.y;const o={left:n,top:a,stroke:q,strokeWidth:X,fill:"transparent",selectable:!1,evented:!1};t="rect"===s?new C.UL({...o,width:0,height:0}):new C.Pj({...o,rx:0,ry:0,originX:"center",originY:"center"}),e.add(t)})),e.on("mouse:move",(i=>{if(!r||!t)return;const l=e.getScenePoint(i.e);"rect"===s?t.set({width:Math.abs(n-l.x),height:Math.abs(a-l.y),left:Math.min(n,l.x),top:Math.min(a,l.y)}):t.set({rx:Math.abs(n-l.x)/2,ry:Math.abs(a-l.y)/2,left:(n+l.x)/2,top:(a+l.y)/2}),e.requestRenderAll()})),e.on("mouse:up",(()=>{r=!1,t&&(t.set({selectable:!0,evented:!0}),t.setCoords()),t=null,W("select")}))}}),[T,q,X,V,E]);return e&&t?(0,r.jsxs)("div",{className:"fixed inset-0 z-[100] bg-gray-900/95 flex flex-col h-full w-full touch-none",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between bg-white px-4 py-3 shrink-0 shadow z-20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:()=>ae(!ne),className:"p-2 rounded-lg transition-colors "+(ne?"bg-blue-100 text-blue-600":"hover:bg-gray-100"),children:r.jsx(a.Z,{size:20})}),r.jsx("h3",{className:"font-semibold text-gray-700 truncate max-w-[150px] md:max-w-md",children:t.fileName})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[R&&!E&&(0,r.jsxs)("button",{onClick:()=>L(!0),className:"flex items-center gap-2 px-3 py-2 text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100",children:[r.jsx(i.Z,{size:18}),r.jsx("span",{className:"hidden sm:inline font-medium",children:"\u0e41\u0e01\u0e49\u0e44\u0e02"})]}),R&&E&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>L(!1),className:"flex items-center gap-2 px-3 py-2 text-gray-600 bg-white border border-gray-300 rounded-lg hover:bg-gray-100",children:[r.jsx(l.Z,{size:18}),r.jsx("span",{className:"hidden sm:inline",children:"\u0e22\u0e01\u0e40\u0e25\u0e34\u0e01"})]}),(0,r.jsxs)("button",{onClick:async()=>{if(Z&&t&&D.current&&R){re(!0);try{de();const{jsPDF:e}=await s.e(8898).then(s.bind(s,48898));let r=null;const n=D.current,a=2;for(let t=1;t<=n.numPages;t++){const s=await n.getPage(t),i=s.getViewport({scale:1}),l=i.width,o=i.height,c=l>o?"landscape":"portrait",d=s.getViewport({scale:a});1===t?r=new e({orientation:c,unit:"px",format:[l,o],hotfixes:["px_scaling"]}):r.addPage([l,o],c);const u=document.createElement("canvas");u.width=d.width,u.height=d.height;const h=u.getContext("2d");h.fillStyle="#FFFFFF",h.fillRect(0,0,u.width,u.height),await s.render({canvasContext:h,viewport:d}).promise;const g=F.current[t];if(g){const e=document.createElement("canvas"),t=new C.yf(e,{width:l,height:o});await t.loadFromJSON(g);const s=t.toDataURL({format:"png",multiplier:a}),r=new Image;r.src=s,await new Promise((e=>{r.onload=e})),h.drawImage(r,0,0)}const x=u.toDataURL("image/jpeg",.85);r.addImage(x,"JPEG",0,0,l,o)}const i=r.output("blob");Z(new File([i],`edited_${t.fileName}`,{type:"application/pdf"}))}catch(e){console.error("Save error:",e),alert("\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01\u0e44\u0e21\u0e48\u0e2a\u0e33\u0e40\u0e23\u0e47\u0e08")}finally{re(!1)}}},disabled:se,className:"flex items-center gap-2 px-3 py-2 text-white rounded-lg transition-colors shadow-sm "+(se?"bg-gray-400":"bg-green-600 hover:bg-green-700"),children:[se?r.jsx(o.Z,{className:"w-4 h-4 animate-spin"}):r.jsx(c.Z,{size:18}),r.jsx("span",{className:"hidden sm:inline font-medium",children:se?"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01...":"\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01"})]})]}),r.jsx("button",{onClick:S,className:"p-2 bg-red-50 text-red-500 rounded-lg hover:bg-red-100",children:r.jsx(d.Z,{size:20})})]})]}),R&&E&&r.jsx("div",{className:"bg-white border-b p-2 overflow-x-auto z-20 shrink-0 shadow-sm hide-scrollbar",children:(0,r.jsxs)("div",{className:"flex items-center gap-4 min-w-max px-2 justify-center lg:justify-start",children:[r.jsx("div",{className:"flex bg-gray-100 p-1 rounded-lg gap-1",children:[{id:"hand",icon:u.Z},{id:"select",icon:h.Z},{id:"draw",icon:i.Z},{id:"text",icon:g.Z},{id:"eraser",icon:x.Z}].map((e=>r.jsx("button",{onClick:()=>W(e.id),className:"p-3 rounded-md transition-colors "+(T===e.id?"bg-white shadow text-blue-600":"text-gray-500 hover:bg-gray-50"),children:r.jsx(e.icon,{size:20})},e.id)))}),r.jsx("div",{className:"w-px h-8 bg-gray-300"}),r.jsx("div",{className:"flex bg-gray-100 p-1 rounded-lg gap-1",children:[{id:"rect",icon:m.Z},{id:"circle",icon:p.Z}].map((e=>r.jsx("button",{onClick:()=>W(e.id),className:"p-3 rounded-md transition-colors "+(T===e.id?"bg-white shadow text-blue-600":"text-gray-500 hover:bg-gray-50"),children:r.jsx(e.icon,{size:20})},e.id)))}),r.jsx("div",{className:"w-px h-8 bg-gray-300"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 border p-1 rounded-lg bg-gray-50",children:[k.map((e=>r.jsx("button",{onClick:()=>J(e),className:"w-6 h-6 rounded-full border-2 transition-all "+(q===e?"ring-2 ring-blue-500 scale-110":"hover:scale-105"),style:{backgroundColor:e}},e))),r.jsx("input",{type:"color",value:q,onChange:e=>J(e.target.value),className:"w-8 h-8 border-none p-0 bg-transparent cursor-pointer"}),r.jsx("div",{className:"w-px h-6 bg-gray-300 mx-2"}),r.jsx("input",{type:"range",min:"1",max:"20",value:X,onChange:e=>Y(Number(e.target.value)),className:"w-20 accent-blue-600"})]}),(0,r.jsxs)("div",{className:"flex gap-2 ml-auto",children:[r.jsx("button",{onClick:()=>{const e=A.current;if(!e)return;const t=e.getObjects();t.length&&(e.remove(t[t.length-1]),e.requestRenderAll())},className:"p-2 hover:bg-gray-100 rounded text-gray-600 transition-colors",children:r.jsx(f.Z,{})}),r.jsx("button",{onClick:()=>{const e=A.current;e&&(e.getActiveObjects().forEach((t=>e.remove(t))),e.discardActiveObject(),e.requestRenderAll())},className:"p-2 hover:bg-red-50 rounded text-red-500 transition-colors",children:r.jsx(b.Z,{})})]})]})}),(0,r.jsxs)("div",{className:"flex-1 relative overflow-hidden flex bg-gray-500/50",children:[ne&&(0,r.jsxs)("div",{className:"absolute inset-y-0 left-0 w-[240px] bg-white shadow-xl z-30 flex flex-col transition-transform duration-300 border-r",children:[(0,r.jsxs)("div",{className:"p-3 border-b bg-gray-50 font-medium text-sm text-gray-600",children:["Pages (",I,")"]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-3",children:Array.from({length:I},((e,t)=>t+1)).map((e=>(0,r.jsxs)("div",{onClick:()=>{he(e),oe&&ae(!1)},className:"cursor-pointer rounded border-2 transition-all p-1 bg-gray-100 "+(B===e?"border-blue-500 ring-1 ring-blue-300":"border-transparent hover:border-gray-300"),children:[r.jsx("div",{className:"w-full flex items-center justify-center bg-white overflow-hidden min-h-[100px]",children:ie[e]?r.jsx("img",{src:ie[e].src,style:{width:"100%",height:"auto"},className:"shadow-sm",alt:`Page ${e}`}):r.jsx("div",{className:"text-gray-400 text-xs",children:"Loading..."})}),r.jsx("div",{className:"text-center text-xs mt-1 font-medium text-gray-500",children:e})]},e)))})]}),r.jsx("div",{ref:z,className:"flex-1 overflow-auto relative touch-none transition-all "+(ne&&!oe?"ml-[240px]":""),style:{backgroundColor:"#6b7280"},children:ee?r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-white flex flex-col items-center",children:[r.jsx(o.Z,{className:"animate-spin h-10 w-10 mb-4"}),"Loading PDF..."]})}):r.jsx("div",{className:"flex items-center justify-center",style:{width:K.width?K.width*V+64+"px":"100%",height:K.height?K.height*V+64+"px":"100%",minWidth:"100%",minHeight:"100%",padding:"32px"},children:r.jsx("div",{ref:P,className:"shadow-2xl",style:{position:"relative",width:K.width?K.width*V+"px":"auto",height:K.height?K.height*V+"px":"auto",backgroundColor:"white"}})})}),(0,r.jsxs)("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex items-center gap-3 z-20 pointer-events-auto",children:[(0,r.jsxs)("div",{className:"bg-white/90 backdrop-blur shadow-lg border rounded-full px-2 py-1 flex items-center gap-1",children:[r.jsx("button",{onClick:()=>ue(O.current-.1),className:"p-2 hover:bg-gray-100 rounded-full text-gray-600 transition-colors",children:r.jsx(w.Z,{size:16})}),(0,r.jsxs)("span",{className:"text-xs font-bold min-w-[3rem] text-center",children:[Math.round(100*V),"%"]}),r.jsx("button",{onClick:()=>ue(O.current+.1),className:"p-2 hover:bg-gray-100 rounded-full text-gray-600 transition-colors",children:r.jsx(v.Z,{size:16})}),r.jsx("div",{className:"w-px h-4 bg-gray-300 mx-1"}),r.jsx("button",{onClick:()=>{if(!z.current||!K.width)return;de();const e=(z.current.clientWidth-64)/K.width;ue(e)},title:"Fit Width",className:"p-2 hover:bg-blue-50 text-blue-600 rounded-full transition-colors",children:r.jsx(j.Z,{size:16})})]}),(0,r.jsxs)("div",{className:"bg-white/90 backdrop-blur shadow-lg border rounded-full px-2 py-1 flex items-center gap-2",children:[r.jsx("button",{onClick:()=>he(B-1),disabled:1===B,className:"p-2 hover:bg-gray-100 rounded-full disabled:opacity-30 transition-colors",children:r.jsx(y.Z,{size:18})}),(0,r.jsxs)("span",{className:"text-xs font-bold min-w-[2rem] text-center",children:[B," / ",I]}),r.jsx("button",{onClick:()=>he(B+1),disabled:B===I,className:"p-2 hover:bg-gray-100 rounded-full disabled:opacity-30 transition-colors",children:r.jsx(N.Z,{size:18})})]})]})]})]}):null}},22834:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});const r=(0,s(68570).createProxy)(String.raw`D:\ttsdoc-v2\src\app\dashboard\layout.tsx#default`)}};