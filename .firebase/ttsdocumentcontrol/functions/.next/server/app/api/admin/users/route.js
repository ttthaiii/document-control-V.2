"use strict";(()=>{var e={id:2628,ids:[2628]};e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},17646:(e,t,E)=>{E.r(t),E.d(t,{originalPathname:()=>c,patchFetch:()=>M,requestAsyncStorage:()=>_,routeModule:()=>R,serverHooks:()=>A,staticGenerationAsyncStorage:()=>D});var r={};E.r(r),E.d(r,{GET:()=>N,dynamic:()=>P});var s=E(49303),I=E(88716),n=E(60670),a=E(87070),o=E(40416),i=E(4458);const P="force-dynamic";async function N(e){try{const t=e.headers.get("authorization");if(!t?.startsWith("Bearer "))return a.NextResponse.json({error:"Unauthorized"},{status:401});const E=t.split("Bearer ")[1],r=await o.CZ.verifyIdToken(E),s=await o.iW.collection("users").doc(r.uid).get();if(!s.exists||s.data()?.role!==i.K$.ADMIN)return a.NextResponse.json({error:"Permission denied"},{status:403});const I=(await o.iW.collection("users").get()).docs.map((e=>{const t=e.data();return{id:e.id,email:t.email,name:t.name||"",employeeId:t.employeeId||"",role:t.role,status:t.status,sites:t.sites||[],createdAt:(t.createdAt||t.acceptedAt)?.toDate?.().toISOString()||null,lastLogin:t.lastLogin?.toDate?.().toISOString()||null}}));return I.sort(((e,t)=>{const E=e.createdAt?new Date(e.createdAt).getTime():0;return(t.createdAt?new Date(t.createdAt).getTime():0)-E})),a.NextResponse.json({success:!0,users:I})}catch(t){return a.NextResponse.json({success:!1,error:t.message},{status:500})}}const R=new s.AppRouteRouteModule({definition:{kind:I.x.APP_ROUTE,page:"/api/admin/users/route",pathname:"/api/admin/users",filename:"route",bundlePath:"app/api/admin/users/route"},resolvedPagePath:"D:\\ttsdoc-v2\\src\\app\\api\\admin\\users\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:_,staticGenerationAsyncStorage:D,serverHooks:A}=R,c="/api/admin/users/route";function M(){return(0,n.patchFetch)({serverHooks:A,staticGenerationAsyncStorage:D})}},4458:(e,t,E)=>{E.d(t,{$p:()=>o,Ge:()=>P,K$:()=>r,NK:()=>N,c9:()=>a,gf:()=>n,n$:()=>i,oU:()=>I,uc:()=>s});const r={ADMIN:"Admin",BIM:"BIM",SITE_ADMIN:"Site Admin",CM:"CM",ME:"ME",SN:"SN",OE:"OE",PE:"PE",PM:"PM",PD:"PD",SE:"SE",FM:"FM",ADMIN_SITE_2:"Adminsite2"},s=[r.BIM,r.ME,r.SN,r.SITE_ADMIN,r.ADMIN,r.PM,r.PE,r.OE],I=[r.SITE_ADMIN,r.ADMIN_SITE_2,r.OE,r.PE,r.ADMIN],n=[r.CM,r.ADMIN,r.SITE_ADMIN,r.PM,r.PE,r.OE],a=(r.PM,r.ADMIN,r.SE,r.FM,[r.PE,r.OE,r.ADMIN]),o=[r.PM,r.ADMIN],i=(r.PD,r.SE,r.FM,{PENDING_REVIEW:"PENDING_REVIEW",PENDING_CM_APPROVAL:"PENDING_CM_APPROVAL",REVISION_REQUIRED:"REVISION_REQUIRED",APPROVED:"APPROVED",APPROVED_WITH_COMMENTS:"APPROVED_WITH_COMMENTS",APPROVED_REVISION_REQUIRED:"APPROVED_REVISION_REQUIRED",REJECTED:"REJECTED",PENDING_FINAL_APPROVAL:"PENDING_FINAL_APPROVAL"}),P={DRAFT:"DRAFT",REJECTED_BY_PM:"REJECTED_BY_PM",PENDING_BIM:"PENDING_BIM",IN_PROGRESS:"IN_PROGRESS",PENDING_ACCEPTANCE:"PENDING_ACCEPTANCE",REVISION_REQUESTED:"REVISION_REQUESTED",COMPLETED:"COMPLETED"},N={[i.PENDING_REVIEW]:"\u0e23\u0e2d\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a",[i.PENDING_CM_APPROVAL]:"\u0e23\u0e2d\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34 (CM/Approver)",[i.REVISION_REQUIRED]:"\u0e41\u0e01\u0e49\u0e44\u0e02",[i.APPROVED]:"\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34",[i.APPROVED_WITH_COMMENTS]:"\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34\u0e15\u0e32\u0e21\u0e04\u0e2d\u0e21\u0e40\u0e21\u0e19\u0e15\u0e4c (\u0e44\u0e21\u0e48\u0e41\u0e01\u0e49\u0e44\u0e02)",[i.APPROVED_REVISION_REQUIRED]:"\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34\u0e15\u0e32\u0e21\u0e04\u0e2d\u0e21\u0e40\u0e21\u0e19\u0e15\u0e4c (\u0e15\u0e49\u0e2d\u0e07\u0e41\u0e01\u0e49\u0e44\u0e02)",[i.REJECTED]:"\u0e44\u0e21\u0e48\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34",[i.PENDING_FINAL_APPROVAL]:"\u0e23\u0e2d SITE \u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34\u0e02\u0e31\u0e49\u0e19\u0e2a\u0e38\u0e14\u0e17\u0e49\u0e32\u0e22",[P.DRAFT]:"\u0e23\u0e2d\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34 (PM)",[P.REJECTED_BY_PM]:"\u0e44\u0e21\u0e48\u0e2d\u0e19\u0e38\u0e21\u0e31\u0e15\u0e34 (PM)",[P.PENDING_BIM]:"\u0e23\u0e2d BIM \u0e23\u0e31\u0e1a\u0e07\u0e32\u0e19",[P.IN_PROGRESS]:"BIM \u0e01\u0e33\u0e25\u0e31\u0e07\u0e14\u0e33\u0e40\u0e19\u0e34\u0e19\u0e01\u0e32\u0e23",[P.PENDING_ACCEPTANCE]:"\u0e23\u0e2d\u0e15\u0e23\u0e27\u0e08\u0e23\u0e31\u0e1a (Site)",[P.REVISION_REQUESTED]:"\u0e02\u0e2d\u0e41\u0e01\u0e49\u0e44\u0e02 (WR)",[P.COMPLETED]:"\u0e40\u0e2a\u0e23\u0e47\u0e08\u0e2a\u0e34\u0e49\u0e19"};i.PENDING_REVIEW,i.PENDING_CM_APPROVAL,i.REVISION_REQUIRED,i.APPROVED,i.REJECTED,i.APPROVED_WITH_COMMENTS,i.APPROVED_REVISION_REQUIRED,i.PENDING_FINAL_APPROVAL,P.DRAFT,P.REJECTED_BY_PM,P.PENDING_BIM,P.IN_PROGRESS,P.PENDING_ACCEPTANCE,P.REVISION_REQUESTED,P.COMPLETED},40416:(e,t,E)=>{E.d(t,{CZ:()=>a,Hf:()=>o,iW:()=>n,SI:()=>i,uE:()=>P,Dh:()=>R,aj:()=>_,_B:()=>N,Lv:()=>D});const r=require("firebase-admin"),s=(e,t)=>r.apps.find((t=>t?.name===e))||r.initializeApp(t,e),I=()=>{const e={credential:r.credential.cert({projectId:process.env.TTSDOC_PROJECT_ID,clientEmail:process.env.TTSDOC_CLIENT_EMAIL,privateKey:process.env.TTSDOC_PRIVATE_KEY?.replace(/\\n/g,"\n")}),storageBucket:"ttsdocumentcontrol.firebasestorage.app"};return s("ttsdoc-v2",e)},n=I().firestore(),a=I().auth(),o=I().storage().bucket(),i=I().messaging(),P=(()=>{const e={credential:r.credential.cert({projectId:process.env.BIM_TRACKING_PROJECT_ID,clientEmail:process.env.BIM_TRACKING_CLIENT_EMAIL,privateKey:process.env.BIM_TRACKING_PRIVATE_KEY?.replace(/\\n/g,"\n")})};return s("bim-tracking",e)})().firestore(),N=()=>n,R=()=>a,_=()=>o,D=()=>P}};var t=require("../../../../webpack-runtime.js");t.C(e);var E=t.X(0,[9276,5972],(()=>{return e=17646,t(t.s=e);var e}));module.exports=E})();