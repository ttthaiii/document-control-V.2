(()=>{var e={};e.id=3,e.ids=[3],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},6069:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),s(2954),s(94040),s(35866);var r=s(23191),a=s(88716),i=s(37922),n=s.n(i),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,2954)),"D:\\ttsdoc-v2\\src\\app\\admin\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,94040)),"D:\\ttsdoc-v2\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["D:\\ttsdoc-v2\\src\\app\\admin\\page.tsx"],u="/admin/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},31635:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},5072:(e,t,s)=>{Promise.resolve().then(s.bind(s,62665))},24282:(e,t,s)=>{Promise.resolve().then(s.bind(s,49346))},62665:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>d,a:()=>c});var r=s(17577),a=s.n(r),i=s(5779),n=s(76),l=s(67967);let o=(0,r.createContext)({user:null,firebaseUser:null,loading:!0,error:null,refetch:async()=>{},logout:async()=>{}});function d({children:e}){let[t,s]=(0,r.useState)(null),[d,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(!0),[x,p]=(0,r.useState)(null),h=async e=>{try{p(null);let t=await (0,n.QT)((0,n.JU)(l.db,"users",e.uid));if(t.exists()){let s=t.data();c({id:e.uid,email:e.email||"",role:s.role,sites:s.sites||[],status:s.status||"ACTIVE",createdFromInvitation:s.createdFromInvitation,createdAt:s.createdAt?.toDate(),acceptedAt:s.acceptedAt?.toDate()})}else p("ไม่พบข้อมูลผู้ใช้ในระบบ"),c(null)}catch(e){console.error("Error fetching user data:",e),p("เกิดข้อผิดพลาดในการโหลดข้อมูลผู้ใช้"),c(null)}},b=async()=>{t&&await h(t)},g=async()=>{try{await (0,i.w7)(l.I),c(null),s(null),p(null)}catch(e){throw console.error("Logout error:",e),e}};return a().createElement(o.Provider,{value:{user:d,firebaseUser:t,loading:u,error:x,refetch:b,logout:g}},e)}function c(){return(0,r.useContext)(o)}},49346:(e,t,s)=>{"use strict";s.d(t,{InviteUserForm:()=>l});var r=s(10326),a=s(17577),i=s(74723),n=s(62665);function l(){let{firebaseUser:e}=(0,n.a)(),[t,s]=(0,a.useState)(!1),[l,o]=(0,a.useState)(null),[d,c]=(0,a.useState)([]),[u,m]=(0,a.useState)(!0),{register:x,handleSubmit:p,reset:h,formState:{errors:b}}=(0,i.cI)({defaultValues:{sites:[]}}),g=async e=>{s(!0),o(null);try{let t=await fetch("/api/admin/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json();s.success?(o({success:!0,invitationUrl:s.invitationUrl}),h()):o({success:!1,error:s.error||"Failed to create invitation"})}catch(e){o({success:!1,error:"Network error occurred"})}finally{s(!1)}};return(0,r.jsxs)("div",{className:"max-w-md mx-auto bg-white p-6 rounded-lg shadow-lg",children:[r.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"เชิญผู้ใช้ใหม่"}),(0,r.jsxs)("form",{onSubmit:p(g),className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"อีเมล"}),r.jsx("input",{type:"email",...x("email",{required:"กรุณาใส่อีเมล"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"user@company.com"}),b.email&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.email.message})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ตำแหน่งงาน"}),(0,r.jsxs)("select",{...x("role",{required:"กรุณาเลือกตำแหน่งงาน"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"-- เลือกตำแหน่งงาน --"}),r.jsx("option",{value:"BIM",children:"BIM"}),r.jsx("option",{value:"Site Admin",children:"Site Admin"}),r.jsx("option",{value:"CM",children:"CM"}),r.jsx("option",{value:"ME",children:"ME (Mechanical/Electrical Engineer)"}),r.jsx("option",{value:"SN",children:"SN (Sanitary Engineer)"})]}),b.role&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.role.message})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"โครงการที่ให้เข้าถึง"}),u?r.jsx("p",{className:"text-sm text-gray-500",children:"Loading sites..."}):r.jsx("div",{className:"mt-2 p-3 border border-gray-200 rounded-md space-y-2 max-h-40 overflow-y-auto",children:d.map(e=>(0,r.jsxs)("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",...x("sites",{required:"กรุณาเลือกอย่างน้อย 1 โครงการ"}),value:e.id,className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"ml-2 text-sm text-gray-700",children:e.name})]},e.id))}),b.sites&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.sites.message})]}),r.jsx("button",{type:"submit",disabled:t||u,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed transition-colors",children:t?"กำลังสร้างคำเชิญ...":"สร้างคำเชิญ"})]}),l&&r.jsx("div",{className:"mt-6",children:l.success?(0,r.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:[r.jsx("h3",{className:"text-green-800 font-medium mb-2",children:"✅ สร้างคำเชิญสำเร็จ!"}),r.jsx("p",{className:"text-green-700 text-sm mb-3",children:"ส่ง link นี้ให้ผู้ใช้:"}),r.jsx("div",{className:"bg-white border rounded p-2",children:r.jsx("code",{className:"text-xs break-all text-gray-800",children:l.invitationUrl})}),r.jsx("button",{onClick:()=>navigator.clipboard.writeText(l.invitationUrl),className:"mt-2 text-xs bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"\uD83D\uDCCB Copy Link"})]}):(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:[r.jsx("h3",{className:"text-red-800 font-medium mb-1",children:"❌ เกิดข้อผิดพลาด"}),r.jsx("p",{className:"text-red-700 text-sm",children:l.error})]})})]})}},67967:(e,t,s)=>{"use strict";s.d(t,{I:()=>l,db:()=>o});var r=s(42585),a=s(5779),i=s(76);let n=(0,r.C6)().length>0?(0,r.C6)()[0]:(0,r.ZF)({apiKey:"AIzaSyAsayb-DEOBE0zi0qh-dPBfihClgXrX1sY",authDomain:"ttsdocumentcontrol.firebaseapp.com",projectId:"ttsdocumentcontrol",storageBucket:"ttsdocumentcontrol.firebasestorage.app",messagingSenderId:"48440915675",appId:"1:48440915675:web:f11611895bfb52d4d27efe"}),l=(0,a.v0)(n),o=(0,i.ad)(n)},2954:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(19510);let a=(0,s(68570).createProxy)(String.raw`D:\ttsdoc-v2\src\lib\components\admin\InviteUserForm.tsx#InviteUserForm`);function i(){return r.jsx("div",{className:"min-h-screen bg-gray-100 py-8",children:(0,r.jsxs)("div",{className:"container mx-auto px-4",children:[r.jsx("h1",{className:"text-3xl font-bold text-center text-gray-800 mb-8",children:"\uD83D\uDC51 Admin Panel - ttsdoc v2"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[r.jsx("div",{children:r.jsx(a,{})}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[r.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:"\uD83D\uDCCB วิธีใช้งาน"}),(0,r.jsxs)("div",{className:"space-y-3 text-sm text-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-start",children:[r.jsx("span",{className:"bg-blue-100 text-blue-800 rounded-full px-2 py-1 text-xs mr-3 mt-0.5",children:"1"}),r.jsx("p",{children:"ใส่อีเมลและเลือกตำแหน่งงานของผู้ใช้ใหม่"})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[r.jsx("span",{className:"bg-blue-100 text-blue-800 rounded-full px-2 py-1 text-xs mr-3 mt-0.5",children:"2"}),r.jsx("p",{children:'คลิก "สร้างคำเชิญ" เพื่อสร้าง invitation link'})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[r.jsx("span",{className:"bg-blue-100 text-blue-800 rounded-full px-2 py-1 text-xs mr-3 mt-0.5",children:"3"}),r.jsx("p",{children:"Copy link และส่งให้ผู้ใช้ทาง LINE, WhatsApp, หรือทางอื่น"})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[r.jsx("span",{className:"bg-blue-100 text-blue-800 rounded-full px-2 py-1 text-xs mr-3 mt-0.5",children:"4"}),r.jsx("p",{children:"ผู้ใช้คลิก link → ตั้งรหัสผ่าน → เข้าใช้งานได้เลย"})]})]}),r.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,r.jsxs)("p",{className:"text-yellow-800 text-sm",children:["\uD83D\uDCA1 ",r.jsx("strong",{children:"Tips:"})," Link จะหมดอายุใน 7 วัน หากผู้ใช้ไม่ได้ใช้งานภายในเวลาที่กำหนด จะต้องสร้าง invitation ใหม่"]})})]})]})]})})}},94040:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,metadata:()=>n});var r=s(19510);s(5023);var a=s(68570);let i=(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\auth\useAuth.ts#AuthProvider`);(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\auth\useAuth.ts#useAuth`);let n={title:"ttsdoc v2 - Construction Document Management",description:"Professional construction document management system"};function l({children:e}){return r.jsx("html",{lang:"th",children:r.jsx("body",{children:r.jsx(i,{children:e})})})}},73881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(66621);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,541,621,723],()=>s(6069));module.exports=r})();