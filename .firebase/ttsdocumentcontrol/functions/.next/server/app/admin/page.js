(()=>{var e={};e.id=3,e.ids=[3],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},6069:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),t(37906),t(87666),t(35866);var s=t(23191),i=t(88716),a=t(37922),n=t.n(a),l=t(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(r,o);let d=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,37906)),"D:\\ttsdoc-v2\\src\\app\\admin\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,87666)),"D:\\ttsdoc-v2\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["D:\\ttsdoc-v2\\src\\app\\admin\\page.tsx"],u="/admin/page",x={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2692:(e,r,t)=>{Promise.resolve().then(t.bind(t,49346)),Promise.resolve().then(t.bind(t,32875))},49346:(e,r,t)=>{"use strict";t.d(r,{InviteUserForm:()=>o});var s=t(10326),i=t(17577),a=t(74723),n=t(26107),l=t(7619);function o(){let{firebaseUser:e}=(0,n.aC)(),[r,t]=(0,i.useState)(!1),[o,d]=(0,i.useState)(null),[c,u]=(0,i.useState)([]),[x,m]=(0,i.useState)(!0),{register:p,handleSubmit:h,reset:E,formState:{errors:N}}=(0,a.cI)({defaultValues:{sites:[]}}),b=async e=>{t(!0),d(null);try{let r=await fetch("/api/admin/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await r.json();t.success?(d({success:!0,invitationUrl:t.invitationUrl}),E()):d({success:!1,error:t.error||"Failed to create invitation"})}catch(e){d({success:!1,error:"Network error occurred"})}finally{t(!1)}};return(0,s.jsxs)("div",{className:"max-w-md mx-auto bg-white p-6 rounded-lg shadow-lg",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"เชิญผู้ใช้ใหม่"}),(0,s.jsxs)("form",{onSubmit:h(b),className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"อีเมล"}),s.jsx("input",{type:"email",...p("email",{required:"กรุณาใส่อีเมล"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"user@company.com"}),N.email&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:N.email.message})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ตำแหน่งงาน"}),(0,s.jsxs)("select",{...p("role",{required:"กรุณาเลือกตำแหน่งงาน"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"-- เลือกตำแหน่งงาน --"}),s.jsx("option",{value:l.K$.BIM,children:"BIM"}),s.jsx("option",{value:l.K$.SITE_ADMIN,children:"Site Admin"}),s.jsx("option",{value:l.K$.OE,children:"OE (Owner Engineer)"}),s.jsx("option",{value:l.K$.PE,children:"PE (Project Engineer)"}),s.jsx("option",{value:l.K$.CM,children:"CM"}),s.jsx("option",{value:l.K$.ME,children:"ME (Mechanical/Electrical Engineer)"}),s.jsx("option",{value:l.K$.SN,children:"SN (Sanitary Engineer)"})]}),N.role&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:N.role.message})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"โครงการที่ให้เข้าถึง"}),x?s.jsx("p",{className:"text-sm text-gray-500",children:"Loading sites..."}):s.jsx("div",{className:"mt-2 p-3 border border-gray-200 rounded-md space-y-2 max-h-40 overflow-y-auto",children:c.map(e=>(0,s.jsxs)("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",...p("sites",{required:"กรุณาเลือกอย่างน้อย 1 โครงการ"}),value:e.id,className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"ml-2 text-sm text-gray-700",children:e.name})]},e.id))}),N.sites&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:N.sites.message})]}),s.jsx("button",{type:"submit",disabled:r||x,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed transition-colors",children:r?"กำลังสร้างคำเชิญ...":"สร้างคำเชิญ"})]}),o&&s.jsx("div",{className:"mt-6",children:o.success?(0,s.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:[s.jsx("h3",{className:"text-green-800 font-medium mb-2",children:"✅ สร้างคำเชิญสำเร็จ!"}),s.jsx("p",{className:"text-green-700 text-sm mb-3",children:"ส่ง link นี้ให้ผู้ใช้:"}),s.jsx("div",{className:"bg-white border rounded p-2",children:s.jsx("code",{className:"text-xs break-all text-gray-800",children:o.invitationUrl})}),s.jsx("button",{onClick:()=>navigator.clipboard.writeText(o.invitationUrl),className:"mt-2 text-xs bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"\uD83D\uDCCB Copy Link"})]}):(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:[s.jsx("h3",{className:"text-red-800 font-medium mb-1",children:"❌ เกิดข้อผิดพลาด"}),s.jsx("p",{className:"text-red-700 text-sm",children:o.error})]})})]})}},37906:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var s=t(19510),i=t(71159),a=t(68570);let n=(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\components\admin\InviteUserForm.tsx#InviteUserForm`),l=(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\components\shared\AuthGuard.tsx#AuthGuard`);(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\components\shared\AuthGuard.tsx#AdminOnly`),(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\components\shared\AuthGuard.tsx#BIMOnly`),(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\components\shared\AuthGuard.tsx#SiteAdminOrAdmin`),(0,a.createProxy)(String.raw`D:\ttsdoc-v2\src\lib\components\shared\AuthGuard.tsx#CMOrAdmin`);var o=t(4458);function d(){return s.jsx(l,{requiredRoles:[o.K$.ADMIN],children:s.jsx("div",{className:"min-h-screen bg-gray-100 py-8",children:(0,s.jsxs)("div",{className:"container mx-auto px-4",children:[s.jsx("h1",{className:"text-3xl font-bold text-center text-gray-800 mb-8",children:"\uD83D\uDC51 Admin Panel - ttsdoc v2"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsx("div",{children:s.jsx(i.Suspense,{fallback:s.jsx("div",{className:"text-center p-8 bg-white rounded-lg shadow",children:"Loading Form..."}),children:s.jsx(n,{})})}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[s.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:"\uD83D\uDCCB วิธีใช้งาน"}),(0,s.jsxs)("div",{className:"space-y-3 text-sm text-gray-700",children:[s.jsx("p",{children:"1. ใส่อีเมลและเลือกตำแหน่งงานของผู้ใช้ใหม่"}),s.jsx("p",{children:'2. คลิก "สร้างคำเชิญ" เพื่อสร้าง invitation link'}),s.jsx("p",{children:"3. Copy link และส่งให้ผู้ใช้"}),s.jsx("p",{children:"4. ผู้ใช้คลิก link → ตั้งรหัสผ่าน → เข้าใช้งานได้เลย"})]}),s.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,s.jsxs)("p",{className:"text-yellow-800 text-sm",children:["\uD83D\uDCA1 ",s.jsx("strong",{children:"Tips:"})," Link จะหมดอายุใน 7 วัน"]})})]})]})]})})})}},4458:(e,r,t)=>{"use strict";t.d(r,{K$:()=>s,gf:()=>n,n$:()=>l,oU:()=>a,uc:()=>i});let s={ADMIN:"Admin",BIM:"BIM",SITE_ADMIN:"Site Admin",CM:"CM",ME:"ME",SN:"SN",OE:"OE",PE:"PE",PM:"PM",SE:"SE",ADMIN_SITE_2:"Adminsite2"},i=[s.BIM,s.ME,s.SN],a=[s.SITE_ADMIN,s.ADMIN_SITE_2,s.OE,s.PE],n=[s.CM];s.PM,s.SE;let l={PENDING_REVIEW:"PENDING_REVIEW",PENDING_CM_APPROVAL:"PENDING_CM_APPROVAL",REVISION_REQUIRED:"REVISION_REQUIRED",APPROVED:"APPROVED",APPROVED_WITH_COMMENTS:"APPROVED_WITH_COMMENTS",APPROVED_REVISION_REQUIRED:"APPROVED_REVISION_REQUIRED",REJECTED:"REJECTED",PENDING_FINAL_APPROVAL:"PENDING_FINAL_APPROVAL"};l.PENDING_REVIEW,l.PENDING_CM_APPROVAL,l.REVISION_REQUIRED,l.APPROVED,l.APPROVED_WITH_COMMENTS,l.APPROVED_REVISION_REQUIRED,l.REJECTED,l.PENDING_FINAL_APPROVAL,l.PENDING_REVIEW,l.PENDING_CM_APPROVAL,l.REVISION_REQUIRED,l.APPROVED,l.REJECTED,l.APPROVED_WITH_COMMENTS,l.APPROVED_REVISION_REQUIRED}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[8948,4490,6621,4723,9860],()=>t(6069));module.exports=s})();