"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[900],{3900:function(e,t,s){s.d(t,{Z:function(){return v}});var a=s(7437),r=s(2265),l=s(2489),i=s(3245),o=s(1817),d=s(401),n=s(6980),c=s(7689),m=s(8736),u=s(6865),x=s(7649);let g=()=>{let[e,t]=(0,r.useState)(!1),[s,a]=(0,r.useState)(null),{firebaseUser:l}=(0,x.a)(),i=(0,r.useCallback)(async(e,t)=>{if(!l)throw Error("User not authenticated");let s=await l.getIdToken(),a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify(t)}),r=await a.json();if(!r.success)throw Error(r.error||"Request failed");return r.data},[l]);return{loading:e,error:s,getProjects:(0,r.useCallback)(async e=>{t(!0),a(null);try{return(await i("/api/google-sheets/projects",e)).projects}catch(e){throw a(e.message),e}finally{t(!1)}},[i]),getCategories:(0,r.useCallback)(async(e,s,r)=>{t(!0),a(null);try{return(await i("/api/google-sheets/categories",{...e,projectName:s,rfaType:r})).categories}catch(e){throw a(e.message),e}finally{t(!1)}},[i]),getTasks:(0,r.useCallback)(async(e,s,r)=>{t(!0),a(null);try{return(await i("/api/google-sheets/tasks",{...e,projectName:s,category:r})).tasks}catch(e){throw a(e.message),e}finally{t(!1)}},[i]),clearError:()=>a(null)}};var h=s(9761),p=s(453),b=s(4001),y=s(6855),f=s(5978);let N={rfaType:"",categoryId:"",documentNumber:"",title:"",description:"",revisionNumber:"00",uploadedFiles:[],selectedProject:"",selectedCategory:"",selectedTask:null},j={"RFA-SHOP":{title:"RFA-SHOP",subtitle:"Shop Drawing Approval",icon:"\uD83C\uDFD7️",description:"สำหรับการขออนุมัติ Shop Drawing",workflow:"ผู้สร้าง → Site Admin → CM",allowedRoles:[p.K$.BIM,p.K$.ME,p.K$.SN,p.K$.SITE_ADMIN,p.K$.ADMIN],color:"blue"},"RFA-GEN":{title:"RFA-GEN",subtitle:"General Submission",icon:"\uD83D\uDCCB",description:"สำหรับการส่งเอกสารทั่วไป",workflow:"ผู้สร้าง → CM",allowedRoles:[p.K$.BIM,p.K$.SITE_ADMIN,p.K$.ADMIN,p.K$.ME,p.K$.SN],color:"green"},"RFA-MAT":{title:"RFA-MAT",subtitle:"Material Approval",icon:"\uD83E\uDDF1",description:"สำหรับการขออนุมัติวัสดุ",workflow:"Site Admin → CM",allowedRoles:[p.K$.SITE_ADMIN,p.K$.ADMIN],color:"orange"}};function v(e){var t,s;let{onClose:v,isModal:w=!1,userProp:k,presetRfaType:T}=e,[C,I]=(0,r.useState)({...N,rfaType:T||""}),[F,S]=(0,r.useState)(!1),[A,D]=(0,r.useState)(!1),[E,M]=(0,r.useState)({}),[R,Z]=(0,r.useState)(!1),[O,P]=(0,r.useState)([]),[K,$]=(0,r.useState)([]),[B,z]=(0,r.useState)([]),[_,J]=(0,r.useState)(""),[G,L]=(0,r.useState)(!1),[H,U]=(0,r.useState)(null),[q,X]=(0,r.useState)(""),{firebaseUser:Q,user:V}=(0,x.a)(),{showNotification:W}=(0,b.l)(),{loading:Y,error:ee,getCategories:et,getTasks:es}=g(),[ea,er]=(0,r.useState)(""),[el,ei]=(0,r.useState)([]),eo=(0,r.useMemo)(()=>!k||"RFA-MAT"===C.rfaType||"RFA-GEN"===C.rfaType||"RFA-SHOP"!==C.rfaType||k.role!==p.K$.BIM,[k,C.rfaType]);(0,r.useEffect)(()=>{(async()=>{if((null==V?void 0:V.sites)&&0!==V.sites.length){D(!0);try{let e=(0,f.IO)((0,f.hJ)(y.db,"sites"),(0,f.ar)((0,f.Jm)(),"in",V.sites)),t=(await (0,f.PL)(e)).docs.map(e=>{var t,s,a,r;return{id:e.id,name:e.data().name,sheetId:(null===(s=e.data().settings)||void 0===s?void 0:null===(t=s.googleSheetsConfig)||void 0===t?void 0:t.spreadsheetId)||"",sheetName:(null===(r=e.data().settings)||void 0===r?void 0:null===(a=r.googleSheetsConfig)||void 0===a?void 0:a.sheetName)||""}});P(t)}catch(e){console.error("Error loading sites:",e),W("error","เกิดข้อผิดพลาด","ไม่สามารถโหลดรายชื่อโครงการได้")}finally{D(!1)}}})()},[V]),(0,r.useEffect)(()=>{if(!_||!C.documentNumber){U(null);return}L(!0);let e=setTimeout(()=>{X(C.documentNumber)},500);return()=>{clearTimeout(e)}},[C.documentNumber,_]),(0,r.useEffect)(()=>{q&&_&&(async()=>{L(!0),U(null);try{let e=await fetch("/api/rfa/check-duplicate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({siteId:_,documentNumber:q})}),t=await e.json();U(!t.isDuplicate)}catch(e){console.error("Failed to check duplicate:",e),U(null)}finally{L(!1)}})()},[q,_]);let ed=e=>{I(t=>({...t,...e}));let t={...E};Object.keys(e).forEach(e=>delete t[e]),M(t)},en=()=>{let e={};if(!T){if(C.rfaType){let t=j[C.rfaType];k&&!t.allowedRoles.includes(k.role)&&(e.rfaType="คุณไม่มีสิทธิ์สร้าง ".concat(C.rfaType))}else e.rfaType="กรุณาเลือกประเภท RFA"}return C.title.trim()||(e.title="กรุณาใส่หัวข้อเอกสาร"),C.revisionNumber.trim()||(e.revisionNumber="กรุณาใส่ Rev. No."),_||(e.site="กรุณาเลือกโครงการ"),C.documentNumber.trim()?!1===H&&(e.documentNumber="เลขที่เอกสารนี้ถูกใช้ไปแล้ว"):e.documentNumber="กรุณาใส่เลขที่เอกสาร",eo?C.categoryId.trim()||(e.categoryId="กรุณากรอกหมวดงาน"):C.selectedTask||(e.task="กรุณาเลือกงานจาก BIM Tracking"),0===C.uploadedFiles.filter(e=>"success"===e.status).length&&(e.files="กรุณาอัปโหลดไฟล์อย่างน้อย 1 ไฟล์"),M(e),0===Object.keys(e).length},ec=async()=>{if(!en()){W("warning","ข้อมูลไม่ครบถ้วน","กรุณากรอกข้อมูลในช่องที่มีเครื่องหมาย * ให้ครบ");return}Z(!0);try{var e;if(!Q)throw Error("กรุณาล็อกอินก่อน");let t=await Q.getIdToken(),s=C.uploadedFiles.filter(e=>"success"===e.status&&e.uploadedData),a=eo?C.categoryId:null===(e=C.selectedTask)||void 0===e?void 0:e.taskCategory,r=eo?null:C.selectedTask;if(!a)throw Error("ไม่สามารถระบุ Category ID ได้");let l={rfaType:C.rfaType,title:C.title,description:C.description,siteId:_,documentNumber:C.documentNumber,revisionNumber:parseInt(C.revisionNumber,10)||0,uploadedFiles:s.map(e=>e.uploadedData),categoryId:a,taskData:r},i=await fetch("/api/rfa/create",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({payload:l})}),o=await i.json();if(!i.ok)throw Error(o.error||"เกิดข้อผิดพลาดในการสร้างเอกสาร");if(o.success)W("success","สร้าง RFA สำเร็จ!","หมายเลขเอกสาร: ".concat(o.runningNumber)),v&&v();else throw Error(o.error)}catch(e){W("error","เกิดข้อผิดพลาด",e instanceof Error?e.message:"An unknown error occurred.")}finally{Z(!1)}},em=async e=>{try{if(!Q)throw Error("กรุณาล็อกอินก่อนอัปโหลดไฟล์");let t=await Q.getIdToken(),s=new FormData;s.append("file",e);let a=await fetch("/api/rfa/upload-temp-file",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:s}),r=await a.json();if(r.success)return{status:"success",progress:100,uploadedData:r.fileData};throw Error(r.error||"อัปโหลดล้มเหลว")}catch(e){return{status:"error",error:e instanceof Error?e.message:"เกิดข้อผิดพลาด"}}},eu=async e=>{let t=Array.from(e.target.files||[]);if(!t.length)return;let s=t.map(e=>({id:"".concat(e.name,"-").concat(Date.now()),file:e,status:"pending",progress:0,retryCount:0}));for(let e of(I(e=>({...e,uploadedFiles:[...e.uploadedFiles,...s]})),s)){I(t=>({...t,uploadedFiles:t.uploadedFiles.map(t=>t.id===e.id?{...t,status:"uploading"}:t)}));let t=await em(e.file);I(s=>({...s,uploadedFiles:s.uploadedFiles.map(s=>s.id===e.id?{...s,...t}:s)}))}e.target.value=""},ex=e=>{var t;null===(t=C.uploadedFiles[e].uploadedData)||void 0===t||t.filePath,ed({uploadedFiles:C.uploadedFiles.filter((t,s)=>s!==e)})},eg=async e=>{if(J(e),ed({categoryId:"",selectedCategory:"",selectedTask:null}),ei([]),$([]),z([]),er(""),!e)return;let t=O.find(t=>t.id===e);if(t){if(D(!0),eo)try{let t=(0,f.IO)((0,f.hJ)(y.db,"sites/".concat(e,"/categories")),(0,f.Xo)("categoryCode")),s=(await (0,f.PL)(t)).docs.map(e=>({id:e.id,categoryCode:e.data().categoryCode,categoryName:e.data().categoryName}));ei(s)}catch(e){console.error("Failed to fetch site categories:",e),M(e=>({...e,site:"ไม่สามารถโหลดหมวดงานได้"}))}finally{D(!1)}else{ed({selectedProject:t.name});try{let e=await et({sheetId:t.sheetId||""},t.name,C.rfaType);$(e)}catch(e){console.error("Failed to fetch categories from BIM-Tracking:",e),M(e=>({...e,site:"ไม่สามารถโหลดหมวดงานจาก BIM-Tracking ได้"}))}finally{D(!1)}}}},eh=async e=>{ed({selectedCategory:e,selectedTask:null}),z([]);let t=O.find(e=>e.id===_);if(t&&C.selectedProject)try{let s=await es({sheetId:t.sheetId||""},C.selectedProject,e);z(s)}catch(e){console.error(e)}},ep=e=>{ed({selectedTask:e,title:"".concat(e.taskName," - RFA")}),er(e.taskName)},eb=(0,r.useMemo)(()=>ea?B.filter(e=>e.taskName.toLowerCase().includes(ea.toLowerCase())):B.slice(0,20),[B,ea]);return(0,a.jsxs)("div",{className:"".concat(w?"max-w-4xl w-full mx-auto":""," bg-white rounded-lg shadow-xl flex flex-col h-full max-h-[95vh]"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b bg-gray-50 rounded-t-lg",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("h2",{className:"text-2xl font-bold text-gray-900",children:["สร้าง RFA Document",C.rfaType&&j[C.rfaType]&&(0,a.jsxs)("span",{className:"font-medium text-gray-600",children:[" - ",j[C.rfaType].subtitle]})]})}),v&&(0,a.jsx)("button",{onClick:v,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(l.Z,{})})]}),(0,a.jsxs)("div",{className:"flex-1 p-4 sm:p-6 overflow-y-auto bg-slate-50 space-y-6",children:[!T&&(0,a.jsxs)("section",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,a.jsxs)("h3",{className:"flex items-center text-lg font-semibold text-gray-900 border-b pb-4 mb-6",children:[(0,a.jsx)("span",{className:"w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center mr-3 font-bold text-base",children:"1"}),"เลือกประเภทเอกสาร"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(j).map(e=>{let[t,s]=e,r=!!k&&s.allowedRoles.includes(k.role);return(0,a.jsxs)("div",{onClick:()=>r&&ed({rfaType:t}),className:"p-6 border-2 rounded-lg text-center cursor-pointer transition-all duration-200 ".concat(C.rfaType===t?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":r?"border-gray-200 hover:border-gray-400":"border-gray-100 bg-gray-50 opacity-60 cursor-not-allowed"),children:[(0,a.jsx)("div",{className:"text-4xl mb-3",children:s.icon}),(0,a.jsx)("h4",{className:"font-semibold text-gray-800",children:s.title}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:s.description})]},t)})}),E.rfaType&&(0,a.jsx)("p",{className:"text-red-600 text-sm mt-2",children:E.rfaType})]}),(0,a.jsxs)("section",{className:"bg-white p-6 rounded-lg border border-gray-200 ".concat(C.rfaType||T?"":"opacity-40 pointer-events-none"),children:[(0,a.jsxs)("h3",{className:"flex items-center text-lg font-semibold text-gray-900 border-b pb-4 mb-6",children:[(0,a.jsx)(i.Z,{size:20,className:"mr-3 text-blue-600"}),"ข้อมูลเอกสาร"]}),(0,a.jsxs)("div",{className:"space-y-6 max-w-3xl",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["โครงการ ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{value:_,onChange:e=>eg(e.target.value),className:"w-full p-3 border rounded-lg bg-gray-50",children:[(0,a.jsx)("option",{value:"",children:"-- เลือกโครงการ --"}),O.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]}),E.site&&(0,a.jsx)("p",{className:"text-red-600 text-sm mt-1",children:E.site})]}),eo?(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"category-manual-input",className:"block text-sm font-medium text-gray-700 mb-2",children:["หมวดงาน ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{id:"category-manual-input",type:"text",list:"category-list",value:C.categoryId,onChange:e=>ed({categoryId:e.target.value}),placeholder:"พิมพ์หรือเลือกหมวดงาน",className:"w-full p-3 border rounded-lg",disabled:!_}),(0,a.jsx)("datalist",{id:"category-list",children:el.map(e=>(0,a.jsx)("option",{value:e.categoryCode},e.id))}),E.categoryId&&(0,a.jsx)("p",{className:"text-red-600 text-sm mt-1",children:E.categoryId})]}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:["หมวดงาน ",Y&&(0,a.jsx)(h.Z,{className:"w-4 h-4 ml-2"})," ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{value:C.selectedCategory,onChange:e=>eh(e.target.value),className:"w-full p-3 border rounded-lg disabled:bg-gray-100 bg-gray-50",disabled:!_||Y,children:[(0,a.jsx)("option",{value:"",children:Y?"กำลังโหลด...":"-- เลือกหมวดงาน --"}),K.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),ee&&(0,a.jsxs)("p",{className:"text-red-600 text-sm mt-1",children:["Error: ",ee]})]})]}),!eo&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["ค้นหางาน ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",placeholder:"ค้นหาชื่องานจาก BIM Tracking...",value:ea,onChange:e=>er(e.target.value),className:"w-full p-3 border rounded-lg",disabled:!C.selectedCategory||Y}),(0,a.jsx)("div",{className:"mt-2 max-h-48 overflow-y-auto border rounded-lg bg-white",children:eb.map(e=>{var t;return(0,a.jsx)("div",{onClick:()=>ep(e),className:"p-3 text-sm cursor-pointer hover:bg-gray-100 ".concat((null===(t=C.selectedTask)||void 0===t?void 0:t.taskName)===e.taskName?"bg-blue-50 font-semibold":""),children:e.taskName},e.taskUid||e.taskName)})}),E.task&&(0,a.jsx)("p",{className:"text-red-600 text-sm mt-1",children:E.task})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"เลขที่เอกสาร"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:C.documentNumber,onChange:e=>{ed({documentNumber:e.target.value}),U(null)},className:"w-full p-3 border rounded-lg pr-10 ".concat(!1===H?"border-red-500":"")}),(0,a.jsxs)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:[G&&(0,a.jsx)(o.Z,{className:"h-5 w-5 text-gray-400 animate-spin"}),!G&&!0===H&&(0,a.jsx)(d.Z,{className:"h-5 w-5 text-green-500"}),!G&&!1===H&&(0,a.jsx)(l.Z,{className:"h-5 w-5 text-red-500"})]})]}),E.documentNumber&&(0,a.jsx)("p",{className:"text-red-600 text-sm mt-1",children:E.documentNumber}),!G&&!1===H&&!E.documentNumber&&(0,a.jsx)("p",{className:"text-red-600 text-sm mt-1",children:"เลขที่เอกสารนี้ถูกใช้ไปแล้ว"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rev. No."}),(0,a.jsx)("input",{type:"text",value:C.revisionNumber,onChange:e=>ed({revisionNumber:e.target.value}),className:"w-full p-3 border rounded-lg"}),E.revisionNumber&&(0,a.jsx)("p",{className:"text-red-600 text-sm mt-1",children:E.revisionNumber})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["หัวข้อเอกสาร ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",value:C.title,onChange:e=>ed({title:e.target.value}),className:"w-full p-3 border rounded-lg"}),E.title&&(0,a.jsx)("p",{className:"text-red-600 text-sm mt-1",children:E.title})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"รายละเอียด"}),(0,a.jsx)("textarea",{value:C.description,onChange:e=>ed({description:e.target.value}),rows:3,className:"w-full p-3 border rounded-lg"})]})]})]}),(0,a.jsxs)("section",{className:"bg-white p-6 rounded-lg border border-gray-200 ".concat(C.rfaType||T?"":"opacity-40 pointer-events-none"),children:[(0,a.jsxs)("h3",{className:"flex items-center text-lg font-semibold text-gray-900 border-b pb-4 mb-6",children:[(0,a.jsx)(n.Z,{size:20,className:"mr-3 text-blue-600"}),"แนบไฟล์ ",(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,a.jsxs)("div",{className:"space-y-6 max-w-3xl",children:[(0,a.jsxs)("label",{htmlFor:"file-upload",className:"flex flex-col items-center justify-center w-full h-48 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-slate-50 hover:bg-slate-100 transition-colors",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6 text-center",children:[(0,a.jsx)(c.Z,{className:"w-10 h-10 mb-4 text-gray-400"}),(0,a.jsxs)("p",{className:"mb-2 text-sm text-gray-500",children:[(0,a.jsx)("span",{className:"font-semibold",children:"คลิกเพื่อเลือกไฟล์"})," หรือลากมาวาง"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"สามารถเลือกได้หลายไฟล์พร้อมกัน"})]}),(0,a.jsx)("input",{id:"file-upload",type:"file",multiple:!0,onChange:eu,className:"hidden"})]}),C.uploadedFiles.length>0&&(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"space-y-2",children:C.uploadedFiles.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center text-sm p-3 bg-gray-100 rounded-lg",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 mr-3 text-gray-500 flex-shrink-0"}),(0,a.jsx)("span",{className:"flex-1 truncate",title:e.file.name,children:e.file.name}),(0,a.jsxs)("div",{className:"flex items-center ml-3",children:["uploading"===e.status&&(0,a.jsx)(h.Z,{className:"w-4 h-4"}),"success"===e.status&&(0,a.jsx)(d.Z,{className:"w-5 h-5 text-green-500"}),"error"===e.status&&(0,a.jsx)("span",{title:e.error,children:(0,a.jsx)(u.Z,{className:"w-5 h-5 text-red-500"})}),(0,a.jsx)("button",{type:"button",onClick:()=>ex(t),className:"ml-4 text-gray-500 hover:text-red-600",children:(0,a.jsx)(l.Z,{size:18})})]})]},e.id))})}),E.files&&(0,a.jsx)("p",{className:"text-red-600 text-sm mt-1",children:E.files})]})]}),E.general&&(0,a.jsx)("p",{className:"text-red-600 text-sm mt-4 text-center",children:E.general})]}),(0,a.jsxs)("div",{className:"flex justify-end items-center p-6 border-t bg-gray-100 rounded-b-lg",children:[v&&(0,a.jsx)("button",{onClick:v,disabled:R,className:"px-6 py-2 rounded-lg bg-white border border-gray-300 text-gray-800 hover:bg-gray-100 disabled:opacity-50 mr-4",children:"ยกเลิก"}),(0,a.jsx)("button",{onClick:()=>{en()?S(!0):alert("กรุณากรอกข้อมูลให้ครบถ้วน")},disabled:R||!C.rfaType&&!T,className:"px-8 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:R?(0,a.jsx)(h.Z,{className:"w-5 h-5"}):"สร้างเอกสาร"})]}),F&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"ยืนยันข้อมูล"}),(0,a.jsxs)("button",{onClick:()=>S(!1),className:"text-gray-400 hover:text-gray-600",children:[" ",(0,a.jsx)(l.Z,{size:24})," "]})]}),(0,a.jsxs)("div",{className:"p-6 overflow-y-auto space-y-4 text-sm",children:[(0,a.jsx)("h4",{className:"text-base font-semibold text-gray-700",children:"กรุณาตรวจสอบข้อมูลก่อนสร้างเอกสาร"}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg border space-y-2",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{className:"font-medium text-gray-500 w-28 inline-block",children:"ประเภท:"})," ",C.rfaType]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{className:"font-medium text-gray-500 w-28 inline-block",children:"โครงการ:"})," ",null===(t=O.find(e=>e.id===_))||void 0===t?void 0:t.name]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{className:"font-medium text-gray-500 w-28 inline-block",children:"หมวดงาน:"})," ",eo?C.categoryId:null===(s=C.selectedTask)||void 0===s?void 0:s.taskCategory]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{className:"font-medium text-gray-500 w-28 inline-block",children:"เลขที่เอกสาร:"})," ",C.documentNumber||"(ไม่ได้ระบุ)"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{className:"font-medium text-gray-500 w-28 inline-block",children:"Rev.:"})," ",C.revisionNumber]}),(0,a.jsxs)("p",{className:"border-t pt-2 mt-2",children:[(0,a.jsx)("strong",{className:"font-medium text-gray-500 block",children:"หัวข้อ:"})," ",C.title]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-500",children:["ไฟล์แนบ (",C.uploadedFiles.filter(e=>"success"===e.status).length," ไฟล์):"]}),(0,a.jsx)("ul",{className:"list-disc list-inside mt-1 space-y-1 text-gray-800",children:C.uploadedFiles.filter(e=>"success"===e.status).map(e=>(0,a.jsx)("li",{className:"truncate",children:e.file.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-4 p-4 border-t bg-gray-50",children:[(0,a.jsx)("button",{onClick:()=>S(!1),className:"px-6 py-2 rounded-lg bg-gray-200 text-gray-800 hover:bg-gray-300",children:" กลับไปแก้ไข "}),(0,a.jsx)("button",{onClick:ec,className:"px-6 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:" ยืนยันและสร้างเอกสาร "})]})]})})]})}}}]);