(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[532],{698:function(e,s,t){Promise.resolve().then(t.bind(t,2623))},9376:function(e,s,t){"use strict";var r=t(5475);t.o(r,"useParams")&&t.d(s,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(s,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},2623:function(e,s,t){"use strict";t.d(s,{AcceptInvitationForm:function(){return o}});var r=t(7437),a=t(2265),n=t(9376),d=t(9501);function o(e){let{token:s}=e,t=(0,n.useRouter)(),[o,l]=(0,a.useState)(!1),[c,i]=(0,a.useState)(null),[u,m]=(0,a.useState)(""),{register:x,handleSubmit:h,watch:b,formState:{errors:p}}=(0,d.cI)(),g=b("password");(0,a.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/invitation/accept?token=".concat(s)),t=await e.json();t.success?i(t.invitation):m(t.error||"Invalid invitation")}catch(e){m("Failed to load invitation")}};s&&e()},[s]);let f=async e=>{l(!0),m("");try{let r=await fetch("/api/invitation/accept",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:s,password:e.password})}),a=await r.json();a.success?(alert("✅ บัญชีผู้ใช้สร้างเสร็จแล้ว! กรุณาเข้าสู่ระบบ"),t.push("/login")):m(a.error||"Failed to create account")}catch(e){m("Network error occurred")}finally{l(!1)}};return c||u?u?(0,r.jsx)("div",{className:"max-w-md mx-auto mt-8 p-6 bg-white rounded-lg shadow-lg",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"❌ ข้อผิดพลาด"}),(0,r.jsx)("p",{className:"text-red-700 mb-4",children:u}),(0,r.jsx)("button",{onClick:()=>t.push("/login"),className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700",children:"กลับสู่หน้าเข้าสู่ระบบ"})]})}):(0,r.jsxs)("div",{className:"max-w-md mx-auto mt-8 p-6 bg-white rounded-lg shadow-lg",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-center text-gray-800 mb-2",children:"\uD83C\uDF89 ยินดีต้อนรับ!"}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:(0,r.jsxs)("p",{className:"text-blue-800 text-sm",children:[(0,r.jsx)("strong",{children:"อีเมล:"})," ",c.email,(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"ตำแหน่งงาน:"})," ",c.role,(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"สถานะ:"})," ",c.status]})}),(0,r.jsxs)("form",{onSubmit:h(f),className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"รหัสผ่าน"}),(0,r.jsx)("input",{type:"password",...x("password",{required:"กรุณาใส่รหัสผ่าน",minLength:{value:6,message:"รหัสผ่านต้องมีอย่างน้อย 6 ตัวอักษร"}}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ใส่รหัสผ่านของคุณ"}),p.password&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p.password.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ยืนยันรหัสผ่าน"}),(0,r.jsx)("input",{type:"password",...x("confirmPassword",{required:"กรุณายืนยันรหัสผ่าน",validate:e=>e===g||"รหัสผ่านไม่ตรงกัน"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ใส่รหัสผ่านอีกครั้ง"}),p.confirmPassword&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p.confirmPassword.message})]}),(0,r.jsx)("button",{type:"submit",disabled:o,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed transition-colors",children:o?"กำลังสร้างบัญชี...":"สร้างบัญชีและเข้าสู่ระบบ"})]}),u&&(0,r.jsx)("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-md p-3",children:(0,r.jsx)("p",{className:"text-red-700 text-sm",children:u})})]}):(0,r.jsx)("div",{className:"max-w-md mx-auto mt-8 p-6 bg-white rounded-lg shadow-lg",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:"กำลังตรวจสอบคำเชิญ..."})]})})}}},function(e){e.O(0,[501,971,117,744],function(){return e(e.s=698)}),_N_E=e.O()}]);