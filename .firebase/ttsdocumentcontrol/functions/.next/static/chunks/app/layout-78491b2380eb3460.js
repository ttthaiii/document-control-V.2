(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7866:function(e,t,r){Promise.resolve().then(r.t.bind(r,4811,23)),Promise.resolve().then(r.t.bind(r,2778,23)),Promise.resolve().then(r.bind(r,7649)),Promise.resolve().then(r.bind(r,2381)),Promise.resolve().then(r.bind(r,4001))},9205:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var n=r(2265);let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),o=e=>{let t=s(e);return t.charAt(0).toUpperCase()+t.slice(1)},a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},l=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let u=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:u="",children:d,iconNode:f,...h}=e;return(0,n.createElement)("svg",{ref:t,...c,width:i,height:i,stroke:r,strokeWidth:o?24*Number(s)/Number(i):s,className:a("lucide",u),...!d&&!l(h)&&{"aria-hidden":"true"},...h},[...f.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let r=(0,n.forwardRef)((r,s)=>{let{className:l,...c}=r;return(0,n.createElement)(u,{ref:s,iconNode:t,className:a("lucide-".concat(i(o(e))),"lucide-".concat(e),l),...c})});return r.displayName=o(e),r}},1671:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9388:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},6865:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},9761:function(e,t,r){"use strict";var n=r(7437);r(2265),t.Z=e=>{let{className:t}=e;return(0,n.jsx)("div",{className:"\n    inline-block h-8 w-8 animate-spin rounded-full \n    border-4 border-solid border-current border-e-transparent \n    align-[-0.125em] text-gray-400 motion-reduce:animate-[spin_1.5s_linear_infinite]\n    ".concat(t||"","\n  ").trim(),role:"status",children:(0,n.jsx)("span",{className:"!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]",children:"Loading..."})})}},7649:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return u},aC:function(){return d}});var n=r(7437),i=r(2265),s=r(2148),o=r(5978),a=r(6855);let l=null,c=(0,i.createContext)({user:null,firebaseUser:null,loading:!0,error:null,refetch:async()=>{},logout:async()=>{}});function u(e){let{children:t}=e,[r,u]=(0,i.useState)(null),[d,f]=(0,i.useState)(null),[h,m]=(0,i.useState)(!0),[p,b]=(0,i.useState)(null),g=async e=>{try{if(b(null),l&&l.firebaseUserId===e.uid&&Date.now()-l.timestamp<3e5){console.log("\uD83D\uDCCB Using cached user data for: ".concat(e.email)),f(l.user);return}console.log("\uD83D\uDD04 Fetching fresh user data for: ".concat(e.email));let n=(0,o.JU)(a.db,"users",e.uid),i=await (0,o.QT)(n);if(i.exists()){var t,r;let n=i.data(),s={id:e.uid,email:e.email||"",role:n.role,sites:n.sites||[],status:n.status||"ACTIVE",createdFromInvitation:n.createdFromInvitation,createdAt:null===(t=n.createdAt)||void 0===t?void 0:t.toDate(),acceptedAt:null===(r=n.acceptedAt)||void 0===r?void 0:r.toDate()};l={user:s,timestamp:Date.now(),firebaseUserId:e.uid},f(s)}else b("ไม่พบข้อมูลผู้ใช้ในระบบ"),f(null)}catch(e){console.error("Error fetching user data:",e),b("เกิดข้อผิดพลาดในการโหลดข้อมูลผู้ใช้"),f(null)}},w=async()=>{r&&(l=null,await g(r))};(0,i.useEffect)(()=>{let e=(0,s.Aj)(a.I,async e=>{(null==e?void 0:e.uid)===(null==r?void 0:r.uid)&&d||(m(!0),u(e),e?await g(e):(f(null),b(null),l=null),m(!1))});return()=>e()},[]);let v=async()=>{try{await (0,s.w7)(a.I),l=null,f(null),u(null),b(null)}catch(e){throw console.error("Logout error:",e),e}};return(0,n.jsx)(c.Provider,{value:{user:d,firebaseUser:r,loading:h,error:p,refetch:w,logout:v},children:t})}function d(){return(0,i.useContext)(c)}},2381:function(e,t,r){"use strict";r.d(t,{LoadingProvider:function(){return c},Y:function(){return l},r:function(){return u}});var n=r(7437),i=r(2265),s=r(9761),o=r(9376);let a=(0,i.createContext)(void 0),l=()=>(0,n.jsx)("div",{className:"absolute inset-0 bg-gray-100 z-30 flex items-center justify-center",children:(0,n.jsx)(s.Z,{className:"w-12 h-12 text-gray-500"})}),c=e=>{let{children:t}=e,[r,s]=(0,i.useState)(!1),l=(0,o.usePathname)(),c=(0,o.useSearchParams)();return(0,i.useEffect)(()=>{s(!1)},[l,c]),(0,n.jsx)(a.Provider,{value:{isLoading:r,showLoader:()=>s(!0),hideLoader:()=>s(!1)},children:t})},u=()=>{let e=(0,i.useContext)(a);if(void 0===e)throw Error("useLoading must be used within a LoadingProvider");return e}},4001:function(e,t,r){"use strict";r.d(t,{NotificationProvider:function(){return f},l:function(){return h}});var n=r(7437),i=r(2265),s=r(1671),o=r(9388),a=r(6865);let l={success:(0,n.jsx)(s.Z,{className:"h-12 w-12 text-green-500"}),error:(0,n.jsx)(o.Z,{className:"h-12 w-12 text-red-500"}),warning:(0,n.jsx)(a.Z,{className:"h-12 w-12 text-yellow-500"})},c={success:"bg-green-600 hover:bg-green-700",error:"bg-red-600 hover:bg-red-700",warning:"bg-yellow-600 hover:bg-yellow-700"};var u=e=>{let{isOpen:t,type:r,title:i,message:s,onClose:o}=e;return t?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-[100] flex items-center justify-center p-4",children:(0,n.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl w-full max-w-sm mx-auto p-6 text-center",children:[(0,n.jsx)("div",{className:"flex justify-center mb-4",children:l[r]}),(0,n.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:i}),s&&(0,n.jsx)("p",{className:"text-gray-600 text-sm mb-6 whitespace-pre-wrap",children:s}),(0,n.jsx)("button",{onClick:o,className:"w-full px-4 py-2 text-white font-semibold rounded-lg transition-colors ".concat(c[r]),children:"ตกลง"})]})}):null};let d=(0,i.createContext)(void 0),f=e=>{let{children:t}=e,[r,s]=(0,i.useState)({isOpen:!1,type:"success",title:"",message:null}),o=(0,i.useCallback)(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";s({isOpen:!0,type:e,title:t,message:r})},[]);return(0,n.jsxs)(d.Provider,{value:{showNotification:o},children:[t,(0,n.jsx)(u,{isOpen:r.isOpen,type:r.type,title:r.title,message:r.message,onClose:()=>{s(e=>({...e,isOpen:!1}))}})]})},h=()=>{let e=(0,i.useContext)(d);if(void 0===e)throw Error("useNotification must be used within a NotificationProvider");return e}},6855:function(e,t,r){"use strict";r.d(t,{I:function(){return a},db:function(){return l}});var n=r(738),i=r(2148),s=r(5978);let o=(0,n.C6)().length>0?(0,n.C6)()[0]:(0,n.ZF)({apiKey:"AIzaSyAsayb-DEOBE0zi0qh-dPBfihClgXrX1sY",authDomain:"ttsdocumentcontrol.firebaseapp.com",projectId:"ttsdocumentcontrol",storageBucket:"ttsdocumentcontrol.firebasestorage.app",messagingSenderId:"48440915675",appId:"1:48440915675:web:f11611895bfb52d4d27efe"}),a=(0,i.v0)(o),l=(0,s.ad)(o);try{(0,s.ST)(l).then(()=>{console.log("✅ Firestore offline persistence enabled.")}).catch(e=>{"failed-precondition"==e.code?console.warn("Firestore persistence failed: Multiple tabs open. Persistence will be enabled in one tab only."):"unimplemented"==e.code&&console.warn("Firestore persistence is not supported in this browser.")})}catch(e){console.error("An error occurred while enabling Firestore persistence:",e)}},2778:function(){},4811:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[2,609,15,783,971,117,744],function(){return e(e.s=7866)}),_N_E=e.O()}]);